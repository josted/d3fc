(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array"),require("d3-scale"),require("d3-time"),require("d3-random"),require("d3-fetch"),require("d3-path"),require("d3-selection"),require("d3-shape"),require("d3-dispatch"),require("d3-brush")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-scale","d3-time","d3-random","d3-fetch","d3-path","d3-selection","d3-shape","d3-dispatch","d3-brush"],t):(e=e||self,t(e.fc={},e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3,e.d3))})(this,function(e,t,a,n,i,l,r,o,s,c,h){'use strict';var O=Math.round,H=Math.floor,N=Math.min,W=Math.ceil,Q=Math.exp,F=Math.max,Y=Math.abs;function g(e){return e}function u(){}function m(e){return"function"==typeof e?e:()=>e}function f(e){return"number"==typeof e&&isNaN(e)?void 0:e}function p(){let e=()=>10,t=u,a=g,n=e=>null!=e;var i=function(i){const l=e.apply(this,arguments),r=i.slice(0,l).map(a);return i.map((e,d)=>(d>=l&&(r.shift(),r.push(a(e,d))),d<l-1||r.some(e=>!n(e))?t(void 0,d):t(r,d)))};return i.period=(...t)=>t.length?(e=m(t[0]),i):e,i.accumulator=(...e)=>e.length?(t=e[0],i):t,i.defined=(...e)=>e.length?(n=e[0],i):n,i.value=(...e)=>e.length?(a=e[0],i):a,i}function y(){let e=2;const a=p().accumulator(a=>{const n=a&&t.deviation(a),i=a&&t.mean(a);return{average:i,upper:f(i+e*n),lower:f(i-e*n)}}),n=e=>a(e);return n.multiplier=(...t)=>t.length?(e=t[0],n):e,X(n,a,"period","value"),n}function x(){let e=g,a=()=>9;const n=e=>{let a=[];return n=>{let i;return a.length<e&&(null==n?a=[]:a.push(n)),a.length>=e&&(i=t.mean(a)),i}},i=function(t){const i=a.apply(this,arguments),l=2/(i+1),r=n(i);let o;return t.map((t,a)=>{const n=e(t,a);return o=void 0===o?r(n):n*l+(1-l)*o,f(o)})};return i.period=(...e)=>e.length?(a=m(e[0]),i):a,i.value=(...t)=>t.length?(e=t[0],i):e,i}function v(){let e=g;const a=x().period(12),n=x().period(26),i=x().period(9),l=l=>{a.value(e),n.value(e);const r=t.zip(a(l),n(l)).map(e=>void 0!==e[0]&&void 0!==e[1]?e[0]-e[1]:void 0),d=i(r);return t.zip(r,d).map(e=>({macd:e[0],signal:e[1],divergence:void 0!==e[0]&&void 0!==e[1]?e[0]-e[1]:void 0}))};return l.value=(...t)=>t.length?(e=t[0],l):e,j(l,a,$({period:"fastPeriod"})),j(l,n,$({period:"slowPeriod"})),j(l,i,$({period:"signalPeriod"})),l}function b(){const e=p().accumulator(e=>e&&t.mean(e)),a=t=>e(t);return X(a,e,"period","value"),a}function S(){let e=.1,t=g;const a=a=>a.map(a=>{const n=f(t(a)*(1-e)),i=f(t(a)*(1+e));return{lower:n,upper:i}});return a.factor=(...t)=>t.length?(e=t[0],a):e,a.value=(...e)=>e.length?(t=e[0],a):t,a}function w(){let e=e=>e.close,a=e=>e.high,n=e=>e.low;const i=x().period(13),l=l=>(i.value(e),t.zip(l,i(l)).map(e=>{const t=f(a(e[0])-e[1]),i=f(n(e[0])-e[1]);return{bullPower:t,bearPower:i}}));return l.closeValue=(...t)=>t.length?(e=t[0],l):e,l.highValue=(...e)=>e.length?(a=e[0],l):a,l.lowValue=(...e)=>e.length?(n=e[0],l):n,X(l,i,"period"),l}function V(){var e={};return e.distance=function(e,t){return t-e},e.offset=function(e,t){return e instanceof Date?new Date(e.getTime()+t):e+t},e.clampUp=e=>e,e.clampDown=e=>e,e.copy=()=>e,e}function k(e,t){const a=[];for(const n of e){const e=t.clampUp(n),i=t.clampDown(n);e===i&&a.push(e)}return a}function A(e){arguments.length||(e=a.scaleIdentity());var t=V();const n=a=>{var n=e.domain(),i=e.range(),l=t.distance(n[0],n[1]),r=t.distance(n[0],a),d=r/l*(i[1]-i[0])+i[0];return d};return n.invert=a=>{var n=e.domain(),i=e.range(),l=(a-i[0])/(i[1]-i[0]),r=t.distance(n[0],n[1]);return t.offset(n[0],l*r)},n.domain=(...a)=>{if(!a.length)return e.domain();const i=a[0];var l=t.clampUp(i[0]),r=t.clampDown(i[1]);return e.domain([l,r]),n},n.nice=()=>{e.nice();var a=e.domain(),i=t.clampUp(a[0]),l=t.clampDown(a[1]);return e.domain([i,l]),n},n.ticks=(...a)=>{var n=e.ticks.apply(this,a);return k(n,t)},n.copy=()=>A(e.copy()).discontinuityProvider(t.copy()),n.discontinuityProvider=(...e)=>e.length?(t=e[0],n):t,j(n,e,J("range","rangeRound","interpolate","clamp","tickFormat")),n}function E(){let e=[e=>e],a=[0,0],n="percent",i=null,l=[];const r=r=>{const d=Array(r.length);for(const t of e)for(let e=0;e<r.length;e++){const a=t(r[e],e);Array.isArray(a)?d.push(...a):d.push(a)}const o=[t.min(d),t.max(d)];if(o[0]=null==o[0]?t.min(l):t.min([o[0],...l]),o[1]=null==o[1]?t.max(l):t.max([o[1],...l]),null!=i){const e=F(Y(o[1]-i),Y(o[0]-i));o[0]=i-e,o[1]=i+e}switch(n){case"domain":{o[0]-=a[0],o[1]+=a[1];break}case"percent":{const e=o[1]-o[0];o[0]-=a[0]*e,o[1]+=a[1]*e;break}default:throw new Error(`Unknown padUnit: ${n}`);}return o};return r.accessors=(...t)=>t.length?(e=t[0],r):e,r.pad=(...e)=>e.length?(a=e[0],r):a,r.padUnit=(...e)=>e.length?(n=e[0],r):n,r.include=(...e)=>e.length?(l=e[0],r):l,r.symmetricalAbout=(...e)=>e.length?(i=e[0],r):i,r}function I(){let e=[],t=[0,0],a="percent",n=null,i=[];const l=E(),r=e=>null==e?null:e.valueOf(),d=d=>{const o=e.map(e=>(...t)=>{const a=e(...t);return Array.isArray(a)?a.map(r):r(a)});return l.accessors(o).pad(t).padUnit(a).symmetricalAbout(null==n?null:n.valueOf()).include(i.map(e=>e.valueOf())),l(d).map(e=>new Date(e))};return d.accessors=(...t)=>t.length?(e=t[0],d):e,d.pad=(...e)=>e.length?(t=e[0],d):t,d.padUnit=(...e)=>e.length?(a=e[0],d):a,d.include=(...e)=>e.length?(i=e[0],d):i,d.symmetricalAbout=(...e)=>e.length?(n=e[0],d):n,d}function T(){let e=1,t=20,a=.1,n=.1,l=i.randomNormal();var r=(i=0)=>{var r=Math.sqrt;const d=e/t,o=[];for(let e=0;e<t+1;e++){o.push(i);const e=l()*r(d)*n+(a-n*n/2)*d;i*=Q(e)}return o};return r.period=(...t)=>t.length?(e=t[0],r):e,r.steps=(...e)=>e.length?(t=e[0],r):t,r.mu=(...e)=>e.length?(a=e[0],r):a,r.sigma=(...e)=>e.length?(n=e[0],r):n,r.random=(...e)=>e.length?(l=e[0],r):l,r}function _(e){return"function"==typeof e?e:()=>e}function P(){let e=new Date,t=100,a=n.timeDay,l=1,r=n.timeYear,d=1,o=null,s=()=>{const e=i.randomNormal(1,.1);return W(1e3*e())};const c=T(),h=e=>{const t=r.offset(e,d)-e;return(a.offset(e,l)-e)/t},g=(e,t)=>{const a=h(e),n=c.period(a)(t),i={date:e,open:n[0],high:F.apply(Math,n),low:N.apply(Math,n),close:n[c.steps()]};return i.volume=s(i),i},u=n=>{let i,r,d;do i=n?a.offset(n.date,l):new Date(e.getTime()),r=n?n.close:t,n=g(i,r),d=o&&!o(n);while(d);return n},m=()=>{let e;const t={};return t.next=()=>{const t=u(e);return e=t,t},t.take=e=>t.until((t,a)=>!e||0>e||a===e),t.until=t=>{const a=[];let n=0,i=u(e),l=t&&!t(i,n);for(;l;)a.push(i),e=i,i=u(e),n+=1,l=t&&!t(i,n);return a},t},f=e=>m().take(e);if(f.stream=m,"function"!=typeof Symbol||"symbol"!=typeof Symbol.iterator)throw new Error("d3fc-random-data depends on Symbol. Make sure that you load a polyfill in older browsers. See README.");return f[Symbol.iterator]=()=>{const e=m();return{next:()=>({value:e.next(),done:!1})}},f.startDate=(...t)=>t.length?(e=t[0],f):e,f.startPrice=(...e)=>e.length?(t=e[0],f):t,f.interval=(...e)=>e.length?(a=e[0],f):a,f.intervalStep=(...e)=>e.length?(l=e[0],f):l,f.unitInterval=(...e)=>e.length?(r=e[0],f):r,f.unitIntervalStep=(...e)=>e.length?(d=e[0],f):d,f.filter=(...e)=>e.length?(o=e[0],f):o,f.volume=(...e)=>e.length?(s=_(e[0]),f):s,j(f,c),f}function B(){var e="BTC-USD",t=null,a=null,n=null,i=function(){var i=[];null!=t&&i.push("start="+t.toISOString()),null!=a&&i.push("end="+a.toISOString()),null!=n&&i.push("granularity="+n);var r="https://api.gdax.com/products/"+e+"/candles?"+i.join("&");return l.json(r).then(function(e){return e.map(function(e){return{date:new Date(1e3*e[0]),open:e[3],high:e[2],low:e[1],close:e[4],volume:e[5]}})})};return i.product=function(t){return arguments.length?(e=t,i):e},i.start=function(e){return arguments.length?(t=e,i):t},i.end=function(e){return arguments.length?(a=e,i):a},i.granularity=function(e){return arguments.length?(n=e,i):n},i}function z(){var e=10,a=a=>1>=e?a.map(e=>[e]):t.range(0,W(a.length/e)).map(t=>a.slice(t*e,(t+1)*e));return a.bucketSize=function(t){return arguments.length?(e=t,a):e},a}function L(){function e(e){var a=e.map(e=>[n(e),i(e)]),l=t.range(1,a.length-1).map(e=>{var t=a[e-1],n=a[e],i=a[e+1];return .5*Y((t[0]-i[0])*(n[1]-t[1])-(t[0]-n[0])*(i[1]-t[1]))});return l}var a=z(),n=e=>e,i=e=>e;const l=n=>{if(a.bucketSize()>=n.length)return n;var i=e(n),l=a(i),r=a(n.slice(1,n.length-1)),d=r.map((e,a)=>{var n=l[a],i=t.max(n),r=n.indexOf(i);return e[r]});return[].concat([n[0]],d,[n[n.length-1]])};return X(l,a,"bucketSize"),l.x=function(e){return arguments.length?(n=e,l):n},l.y=function(e){return arguments.length?(i=e,l):i},l}function C(){var e=e=>e,a=e=>e,n=z();const i=i=>{if(n.bucketSize()>=i.length)return i;var l=n(i.slice(1,i.length-1)),r=i[0],d=i[i.length-1],o=[].concat([r],l,[d]),s=e(r),c=a(r),h=l.map((n,l)=>{var i=t.mean(o[l+1],e),r=t.mean(o[l+1],a),d=n.map(t=>[e(t),a(t)]),h=d.map(e=>.5*Y((s-i)*(e[1]-c)-(s-e[0])*(r-c))),g=h.indexOf(t.max(h)),u=d[g];return s=u[0],c=u[1],n[g]});return[].concat([i[0]],h,[i[i.length-1]])};return X(i,n,"bucketSize"),i.x=function(t){return arguments.length?(e=t,i):e},i.y=function(e){return arguments.length?(a=e,i):a},i}function D(){var e=z(),a=e=>e;const n=n=>{if(e.bucketSize()>n.length)return n;var i=t.extent(n,a),l=e(n.slice(1,n.length-1)),r=l.map(e=>{var t,n,l={},r=!0,d=e.map(a),o=d.filter(e=>e===i[0]||e===i[1]).map(e=>d.indexOf(e))[0];return void 0===o?(d.forEach((e,a)=>{void 0===l[e]&&(l[e]=0),l[e]++,l[e]>l[t]||void 0===t?(t=e,n=a,r=!0):l[e]===l[t]&&(r=!1)}),r?e[n]:e[H(e.length/2)]):e[o]});return[].concat([n[0]],r,[n[n.length-1]])};return X(n,e,"bucketSize"),n.value=function(e){return arguments.length?(a=e,n):a},n}function R(){const e=arguments;return function(t,a){for(let n=0,i=e.length;n<i;n++)if(null==e[n](t,a))return!1;return!0}}var G="default"in a?a["default"]:a,M="default"in s?s["default"]:s,U=(e,t,a)=>{const n=t[a];if("function"!=typeof n)throw new Error(`Attempt to rebind ${a} which isn't a function on the source object`);return(...a)=>{var i=n.apply(t,a);return i===t?e:i}},X=(e,t,...a)=>{for(const n of a)e[n]=U(e,t,n);return e};const q=e=>t=>e.reduce((e,t)=>e&&t(e),t);var j=(e,t,...a)=>{const n=q(a);for(const i of Object.keys(t)){const a=n(i);a&&(e[a]=U(e,t,i))}return e},K=e=>e.map(e=>"string"==typeof e?new RegExp(`^${e}$`):e),Z=(...e)=>(e=K(e),t=>e.every(e=>!e.test(t))&&t),J=(...e)=>(e=K(e),t=>e.some(e=>e.test(t))&&t),$=e=>t=>e[t];const ee=e=>e[0].toUpperCase()+e.slice(1);var te=e=>t=>e+ee(t);const ae=(e,t,a,n)=>{const i={sunday:0,monday:1,saturday:6},l=86400000,r=5*l,d={},o=t=>0===e(t)||6===e(t);return d.clampDown=a=>{if(a&&o(a)){const n=t.ceil(a);return e(n)===i.sunday?t.offset(n,-1):e(n)===i.monday?t.offset(n,-2):n}return a},d.clampUp=a=>{if(a&&o(a)){const n=t.floor(a);return e(n)===i.saturday?t.offset(n,2):e(n)===i.sunday?t.offset(n,1):n}return a},d.distance=function(e,t){e=d.clampUp(e),t=d.clampDown(t);const n=a.ceil(e);if(t<n)return t.getTime()-e.getTime();const i=n.getTime()-e.getTime(),o=a.ceil(t),s=o.getTime()-t.getTime(),c=O((o.getTime()-n.getTime())/(7*l));return c*r+i-s},d.offset=function(e,i){let l=o(e)?d.clampUp(e):e;if(0===i)return l;const s=0>i;let c=i;const h=s?n.floor(l):a.ceil(l);if(c-=h.getTime()-l.getTime(),s&&0<c||0<i&&0>c)return new Date(l.getTime()+i);l=s?h:t.offset(h,2);const g=H(c/r);return l=t.offset(l,7*g),c-=g*r,l=new Date(l.getTime()+c),l},d.copy=function(){return d},d};var ne=e=>"function"==typeof e?e:()=>e,ie=()=>{let e=null,t=e=>e.date,a=e=>e.open,n=e=>e.high,l=e=>e.low,o=e=>e.close,s="vertical",c=ne(3);const h=function(i){const h=e||r.path();return i.forEach(function(e,r){const i=t(e,r),d=a(e,r),g=n(e,r),u=l(e,r),m=o(e,r),f=c(e,r)/2;"vertical"===s?(h.moveTo(i,u),h.lineTo(i,g),h.moveTo(i,d),h.lineTo(i-f,d),h.moveTo(i,m),h.lineTo(i+f,m)):(h.moveTo(u,i),h.lineTo(g,i),h.moveTo(d,i),h.lineTo(d,i+f),h.moveTo(m,i),h.lineTo(m,i-f))}),e?null:h.toString()};return h.context=(...t)=>t.length?(e=t[0],h):e,h.x=(...e)=>e.length?(t=ne(e[0]),h):t,h.open=(...e)=>e.length?(a=ne(e[0]),h):a,h.high=(...e)=>e.length?(n=ne(e[0]),h):n,h.low=(...e)=>e.length?(l=ne(e[0]),h):l,h.close=(...e)=>e.length?(o=ne(e[0]),h):o,h.width=(...e)=>e.length?(c=ne(e[0]),h):c,h.orient=(...e)=>e.length?(s=e[0],h):s,h},le=()=>{let e=null,t=e=>e.x,a=e=>e.y,n="center",i="center",l=e=>e.height,o=ne(3);const s=function(d,s){const c=e||r.path();return d.forEach(function(e,r){const d=t.call(this,e,s||r),h=a.call(this,e,s||r),g=l.call(this,e,s||r),u=o.call(this,e,s||r);let m;switch(n){case"left":m=u;break;case"right":m=0;break;case"center":m=u/2;break;default:throw new Error("Invalid horizontal alignment "+n);}let f;switch(i){case"bottom":f=-g;break;case"top":f=0;break;case"center":f=g/2;break;default:throw new Error("Invalid vertical alignment "+i);}c.rect(d-m,h-f,u,g)},this),e?null:c.toString()};return s.context=(...t)=>t.length?(e=t[0],s):e,s.x=(...e)=>e.length?(t=ne(e[0]),s):t,s.y=(...e)=>e.length?(a=ne(e[0]),s):a,s.width=(...e)=>e.length?(o=ne(e[0]),s):o,s.horizontalAlign=(...e)=>e.length?(n=e[0],s):n,s.height=(...e)=>e.length?(l=ne(e[0]),s):l,s.verticalAlign=(...e)=>e.length?(i=e[0],s):i,s},re=()=>{let e=null,t=e=>e.date,a=e=>e.open,n=e=>e.high,l=e=>e.low,o=e=>e.close,s=ne(3);const c=function(i){const c=e||r.path();return i.forEach(function(e,r){const i=t(e,r),d=a(e,r),h=n(e,r),g=l(e,r),u=o(e,r),m=s(e,r);c.rect(i-m/2,d,m,u-d),c.moveTo(i,N(u,d)),c.lineTo(i,h),c.moveTo(i,F(u,d)),c.lineTo(i,g)}),e?null:c.toString()};return c.context=(...t)=>t.length?(e=t[0],c):e,c.x=(...e)=>e.length?(t=ne(e[0]),c):t,c.open=(...e)=>e.length?(a=ne(e[0]),c):a,c.high=(...e)=>e.length?(n=ne(e[0]),c):n,c.low=(...e)=>e.length?(l=ne(e[0]),c):l,c.close=(...e)=>e.length?(o=ne(e[0]),c):o,c.width=(...e)=>e.length?(s=ne(e[0]),c):s,c},de=()=>{let e=null,t=e=>e.value,a=e=>e.median,n=e=>e.upperQuartile,l=e=>e.lowerQuartile,o=e=>e.high,s=e=>e.low,c="vertical",h=ne(5),g=ne(.5);const u=function(i){const u=e||r.path();return i.forEach(function(e,r){const i=t(e,r),d=h(e,r),m=d/2,f=d*g(e,r),p=f/2,y=o(e,r),x=n(e,r),v=a(e,r),b=l(e,r),S=s(e,r),w=b-x;"vertical"===c?(u.moveTo(i-p,y),u.lineTo(i+p,y),u.moveTo(i,y),u.lineTo(i,x),u.rect(i-m,x,d,w),u.moveTo(i-m,v),u.lineTo(i+m,v),u.moveTo(i,b),u.lineTo(i,S),u.moveTo(i-p,S),u.lineTo(i+p,S)):(u.moveTo(S,i-p),u.lineTo(S,i+p),u.moveTo(S,i),u.lineTo(b,i),u.rect(b,i-m,-w,d),u.moveTo(v,i-m),u.lineTo(v,i+m),u.moveTo(x,i),u.lineTo(y,i),u.moveTo(y,i-p),u.lineTo(y,i+p))}),e?null:u.toString()};return u.context=(...t)=>t.length?(e=t[0],u):e,u.value=(...e)=>e.length?(t=ne(e[0]),u):t,u.median=(...e)=>e.length?(a=ne(e[0]),u):a,u.upperQuartile=(...e)=>e.length?(n=ne(e[0]),u):n,u.lowerQuartile=(...e)=>e.length?(l=ne(e[0]),u):l,u.high=(...e)=>e.length?(o=ne(e[0]),u):o,u.low=(...e)=>e.length?(s=ne(e[0]),u):s,u.width=(...e)=>e.length?(h=ne(e[0]),u):h,u.orient=(...e)=>e.length?(c=e[0],u):c,u.cap=(...e)=>e.length?(g=ne(e[0]),u):g,u},oe=()=>{let e=null,t=e=>e.x,a=e=>e.high,n=e=>e.low,l="vertical",o=ne(5);const s=function(i){const s=e||r.path();return i.forEach(function(e,r){const i=t(e,r),d=o(e,r),c=d/2,h=a(e,r),g=n(e,r);"vertical"===l?(s.moveTo(i-c,h),s.lineTo(i+c,h),s.moveTo(i,h),s.lineTo(i,g),s.moveTo(i-c,g),s.lineTo(i+c,g)):(s.moveTo(g,i-c),s.lineTo(g,i+c),s.moveTo(g,i),s.lineTo(h,i),s.moveTo(h,i-c),s.lineTo(h,i+c))}),e?null:s.toString()};return s.context=(...t)=>t.length?(e=t[0],s):e,s.value=(...e)=>e.length?(t=ne(e[0]),s):t,s.high=(...e)=>e.length?(a=ne(e[0]),s):a,s.low=(...e)=>e.length?(n=ne(e[0]),s):n,s.width=(...e)=>e.length?(o=ne(e[0]),s):o,s.orient=(...e)=>e.length?(l=e[0],s):l,s},se=e=>"function"==typeof e?e:()=>e;const ce=1e-6;var he=(e,t)=>{e=e||"g";let a=(e,t)=>t,n=null;const i=function(i,l){l=l||(e=>e);const r=i.selection?i:null;r&&(i=i.selection());const d=i.selectAll((e,t,a)=>Array.from(a[t].childNodes).filter(e=>1===e.nodeType)).filter(null==t?e:`${e}.${t}`);let o=d.data(l,a);const s=o.enter().append(e).attr("class",t);let c=o.exit();o=o.merge(s);const h=r||n;return h&&(o=o.transition(h).style("opacity",1),s.style("opacity",ce),c=c.transition(h).style("opacity",ce)),c.remove(),o.enter=()=>s,o.exit=()=>c,o};return i.element=(...t)=>t.length?(e=t[0],i):e,i.className=(...e)=>e.length?(t=e[0],i):t,i.key=(...e)=>e.length?(a=e[0],i):a,i.transition=(...e)=>e.length?(n=e[0],i):n,i};const ge=(e,t)=>!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y);var ue=(e,t)=>{if(ge(e,t)){const a=F(e.x,t.x),n=N(e.x+e.width,t.x+t.width),i=F(e.y,t.y),l=N(e.y+e.height,t.y+t.height);return(n-a)*(l-i)}return 0};const me=(e,a)=>t.sum(e.map((t,n)=>a===n?0:ue(e[a],t))),fe=(e,t,a,n,i)=>({x:e,y:t,width:a,height:n,location:i});var pe=e=>{const t=e.x,a=e.y,n=e.width,i=e.height;return[fe(t,a,n,i,"bottom-right"),fe(t-n,a,n,i,"bottom-left"),fe(t-n,a-i,n,i,"top-left"),fe(t,a-i,n,i,"top-right"),fe(t,a-i/2,n,i,"middle-right"),fe(t-n/2,a,n,i,"bottom-center"),fe(t-n,a-i/2,n,i,"middle-left"),fe(t-n/2,a-i,n,i,"top-center")]};const ye=(e,t,a)=>[...e.slice(0,t),a,...e.slice(t+1)],xe=(e,t)=>e<t,ve=()=>{let e,a=null,n=xe,l=()=>0;const r=(t,n)=>a-l(e[n],n,e)+l(t,n,ye(e,n,t)),d=(i,o)=>{a||(a=t.sum(e.map((t,a)=>l(t,a,e))));const s=r(i,o);return n(s,a)?ve().locationScore(l).winningScore(n).score(s).rectangles(ye(e,o,i)):d};return d.rectangles=(...t)=>t.length?(e=t[0],d):e,d.score=(...e)=>e.length?(a=e[0],d):a,d.winningScore=(...e)=>e.length?(n=e[0],d):n,d.locationScore=(...e)=>e.length?(l=e[0],d):l,d};const be=e=>e[Se(e)],Se=e=>H(Math.random()*e.length);const we=(e,a)=>e[t.scan(e,a)];var Ve=e=>"function"==typeof e?e:()=>e,ke=(e,t)=>"left"===e?t/2:"right"===e?-t/2:0,Ae=e=>{const t=Object.assign({},e),a=()=>{};return Object.keys(t).forEach(e=>{a[e]=(...n)=>n.length?(t[e]=n[0],a):t[e]}),a},Ee=()=>{let e=()=>0,t=e=>e.x,n=e=>e.y,l="center",r=()=>5,o="vertical";const s=Ae({decorate:()=>{},defined:(a,l)=>R(e,t,n)(a,l),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return s.values=(a,d)=>{const i=r(a,d),c=ke(l,i),h=s.xScale(),g=s.yScale();if("vertical"===o){const l=g(n(a,d),d),r=g(e(a,d),d),o=h(t(a,d),d)+c;return{d:a,x:o,y:l,y0:r,width:i,height:l-r,origin:[o,l],baseOrigin:[o,r],transposedX:o,transposedY:l}}else{const l=h(n(a,d),d),r=h(e(a,d),d),o=g(t(a,d),d)+c;return{d:a,x:o,y:l,y0:r,width:i,height:l-r,origin:[l,o],baseOrigin:[r,o],transposedX:l,transposedY:o}}},s.xValues=()=>"vertical"===o?[t]:[e,n],s.yValues=()=>"vertical"===o?[e,n]:[t],s.baseValue=(...t)=>t.length?(e=Ve(t[0]),s):e,s.crossValue=(...e)=>e.length?(t=Ve(e[0]),s):t,s.mainValue=(...e)=>e.length?(n=Ve(e[0]),s):n,s.bandwidth=(...e)=>e.length?(r=Ve(e[0]),s):r,s.align=(...e)=>e.length?(l=e[0],s):l,s.orient=(...e)=>e.length?(o=e[0],s):o,s};var Ie={red:"#c60",green:"#6c0",black:"#000",gray:"#ddd",darkGray:"#999"},Te=()=>{const e=Ee(),t=s.line().x((t,a)=>e.values(t,a).transposedX).y((t,a)=>e.values(t,a).transposedY),a=he("path","line"),n=n=>{n.selection&&a.transition(n),t.defined(e.defined()),n.each((n,i,l)=>{const r=a(o.select(l[i]),[n]);r.enter().attr("fill","none").attr("stroke",Ie.black),r.attr("d",t),e.decorate()(r,n,i)})};return j(n,e,Z("baseValue","bandwidth","align")),X(n,a,"key"),X(n,t,"curve"),n},_e=()=>{const e=Ee(),t=s.line().x((t,a)=>e.values(t,a).transposedX).y((t,a)=>e.values(t,a).transposedY),a=a=>{const n=t.context();n.beginPath(),t.defined(e.defined())(a),n.strokeStyle=Ie.black,n.fillStyle="transparent",e.decorate()(n,a),n.fill(),n.stroke(),n.closePath()};return j(a,e,Z("baseValue","bandwidth","align")),X(a,t,"curve","context"),a},Pe=()=>{const e={},t={},a=(a,n,i,l)=>{Object.keys(e).forEach(t=>{e[t](a,n,t,i,l)}),Object.keys(t).forEach(e=>{t[e](a,n,e)})};return a.attribute=(...t)=>1===t.length?e[t[0]]:(e[t[0]]=t[1],a),a.uniform=(...e)=>1===e.length?t[e[0]]:(t[e[0]]=e[1],a),a};const Be={FLOAT:5126};var ze=()=>{let e=null,t=1,a=Be.FLOAT,n=!1,i=0,l=0;const r=(t,a,n)=>{null==e&&(e=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,e);const i=t.getAttribLocation(a,n);t.vertexAttribPointer(i,r.size(),r.type(),r.normalized(),r.stride(),r.offset()),t.enableVertexAttribArray(i)};return r.buffer=(...t)=>t.length?(e=t[0],r):e,r.size=(...e)=>e.length?(t=e[0],r):t,r.type=(...e)=>e.length?(a=e[0],r):a,r.normalized=(...e)=>e.length?(n=e[0],r):n,r.stride=(...e)=>e.length?(i=e[0],r):i,r.offset=(...e)=>e.length?(l=e[0],r):l,r},Le=()=>{const e=ze();let t=(e,t,a,n,i)=>e[i],a=null,n=0;const i=(n,i)=>{const l=e.size(),r=e.offset(),d=new Float32Array(r+n*i*l);let o=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)for(let i=0;i<l;i++)d[r+o++]=t(a,e,n,i,o);return d},l=(t,a,l,r,d)=>{if(!(n>=d)){const o=i(d,r);e(t,a,l),t.bindBuffer(t.ARRAY_BUFFER,e.buffer()),t.bufferData(t.ARRAY_BUFFER,o,t.DYNAMIC_DRAW),n=d}};return l.value=(...e)=>e.length?(t=e[0],n=0,l):t,l.data=(...e)=>e.length?(a=e[0],n=0,l):a,j(l,e,Z("buffer")),l},Ce=e=>{let t=e,a=!0,n=(e,a,n)=>{const i=e.getUniformLocation(a,n);if(t instanceof Array)switch(t.length){case 1:e.uniform1fv(i,t);break;case 2:e.uniform2fv(i,t);break;case 3:e.uniform3fv(i,t);break;case 4:e.uniform4fv(i,t);break;default:throw new Error(`Uniform supports up to 4 elements. ${t.length} provided.`);}else e.uniform1f(i,t)};const i=(e,t,i)=>{a&&(a=!1,n(e,t,i))};return i.bind=(...e)=>e.length?(n=e[0],i):n,i.data=(...e)=>e.length?(t=e[0],a=!0,i):t,i},De=e=>{function t(e,t){e.push(t)}function a(e,t,a){const n=e.indexOf(a);e.splice(0<=n?n:e.length,0,t)}function n(e,t){const a=e.indexOf(t);-1===a&&e.push(t)}const i=[],l=[],r=()=>e(i.join("\n"),l.join("\n"));return r.appendHeader=e=>(t(i,e),r),r.insertHeader=(e,t)=>(a(i,e,t),r),r.appendHeaderIfNotExists=e=>(n(i,e),r),r.appendBody=e=>(t(l,e),r),r.insertBody=(e,t)=>(a(l,e,t),r),r.appendBodyIfNotExists=e=>(n(l,e),r),r};const Re=(e,t)=>`
precision mediump float;
float inf = 1.0 / 0.0;
${e}
void main() {
    ${t}
}`,Oe=(e,t)=>`
precision mediump float;
${e}
void main() {
    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
    ${t}
}`;var He={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Ne=()=>{function e(e,t,a){if(!e)return!0;const i=n.getAttachedShaders(e),l=n.getShaderSource(i[0]),r=n.getShaderSource(i[1]);return t!==l||a!==r}function t(e,t){const i=a(e,n.VERTEX_SHADER),l=a(t,n.FRAGMENT_SHADER),r=n.createProgram();if(n.attachShader(r,i),n.attachShader(r,l),n.linkProgram(r),!n.getProgramParameter(r,n.LINK_STATUS)){const a=n.getProgramInfoLog(r);throw n.deleteProgram(r),new Error(`Failed to link program : ${a}
            Vertex Shader : ${e}
            Fragment Shader : ${t}`)}return r}function a(e,t){const a=n.createShader(t);if(n.shaderSource(a,e),n.compileShader(a),!n.getShaderParameter(a,n.COMPILE_STATUS)){const t=n.getShaderInfoLog(a);throw n.deleteShader(a),new Error(`Failed to compile shader : ${t}
            Shader : ${e}`)}return a}let n=null,i=null,l=null,r=null,d=He.TRIANGLES,o=Pe(),s=1;const c=a=>{const c=l(),h=r();e(i,c,h)&&(n.isProgram(i)&&n.deleteProgram(i),i=t(c,h)),n.useProgram(i),o.uniform("uScreen",Ce([n.canvas.width,n.canvas.height])),o(n,i,s,a),n.drawArrays(d,0,a*s)};return c.context=(...e)=>e.length?(n=e[0],c):n,c.buffers=(...e)=>e.length?(o=e[0],c):o,c.vertexShader=(...e)=>e.length?(l=e[0],c):l,c.fragmentShader=(...e)=>e.length?(r=e[0],c):r,c.mode=(...e)=>e.length?(d=e[0],c):d,c.verticesPerElement=(...e)=>e.length?(s=e[0],c):s,c},We=()=>{let e=[0,1],t=[-1,1],a=0;const n=()=>{};return n.domain=(...t)=>t.length?(e=t[0],n):e,n.range=(...e)=>e.length?(t=e[0],n):t,n.coordinate=(...e)=>e.length?(a=e[0],n):a,n},Qe=()=>{function e(e){e.vertexShader().appendHeader(`uniform vec4 ${a()}Offset;`).appendHeader(`uniform vec4 ${a()}Scale;`),n.scaleComponent(e,"gl_Position")}const t=We(),a=()=>`linear${t.coordinate()}`,n=n=>{e(n);const i=t.domain()[1]-t.domain()[0],l=t.range()[1]-t.range()[0],r=t.range()[0]*(i/l)-t.domain()[0],d=[0,0,0,0],o=[1,1,1,1];d[t.coordinate()]=r,o[t.coordinate()]=l/i,n.buffers().uniform(`${a()}Offset`,Ce(d)).uniform(`${a()}Scale`,Ce(o))};return n.scaleComponent=(e,t)=>(e.vertexShader().appendBody(`${t} = ${t} + ${a()}Offset;`).appendBody(`${t} = ${t} * ${a()}Scale;`),n),j(n,t),n},Fe=()=>{function e(e,t){var a=Math.log10;return a(e)/a(t)}function t(e){e.vertexShader().appendHeader(`uniform vec4 ${i()}Offset;`).appendHeader(`uniform vec4 ${i()}Scale;`).appendHeader(`uniform vec4 ${i()}Include;`).appendHeader(`uniform float ${i()}Base;`),l.scaleComponent(e,"gl_Position")}const a=We();let n=10;const i=()=>`log${a.coordinate()}`,l=l=>{t(l);const r=e(a.domain()[1],n)-e(a.domain()[0],n),d=a.range()[1]-a.range()[0],o=d/r,s=a.range()[0]-o*e(a.domain()[0],n),c=[0,0,0,0],h=[0,0,0,0],g=[0,0,0,0];c[a.coordinate()]=s,h[a.coordinate()]=o,g[a.coordinate()]=1,l.buffers().uniform(`${i()}Offset`,Ce(c)).uniform(`${i()}Scale`,Ce(h)).uniform(`${i()}Include`,Ce(g)).uniform(`${i()}Base`,Ce(n))};return l.scaleComponent=(e,t)=>{const a=`${i()}Offset + (${i()}Scale * clamp(log(${t}) / log(${i()}Base), -inf, inf))`;return e.vertexShader().appendBody(`${t} = (${i()}Include * (${a})) + ((1.0 - ${i()}Include) * ${t});`),l},l.base=(...e)=>e.length?(n=e[0],l):n,j(l,a),l},Ye=()=>{function e(t,a){var e=Math.pow,n=Math.sign;return n(t)*e(Y(t),a)}function t(e){e.vertexShader().appendHeader(`uniform vec4 ${i()}Offset;`).appendHeader(`uniform vec4 ${i()}Scale;`).appendHeader(`uniform vec4 ${i()}Include;`).appendHeader(`uniform float ${i()}Exp;`),l.scaleComponent(e,"gl_Position")}const a=We();let n=1;const i=()=>`pow${a.coordinate()}`,l=l=>{t(l);const r=e(a.domain()[1],n)-e(a.domain()[0],n),d=a.range()[1]-a.range()[0],o=d/r,s=a.range()[0]-o*e(a.domain()[0],n),c=[0,0,0,0],h=[0,0,0,0],g=[0,0,0,0];c[a.coordinate()]=s,h[a.coordinate()]=o,g[a.coordinate()]=1,l.buffers().uniform(`${i()}Offset`,Ce(c)).uniform(`${i()}Scale`,Ce(h)).uniform(`${i()}Include`,Ce(g)).uniform(`${i()}Exp`,Ce(n))};return l.scaleComponent=(e,t)=>{const a=`${i()}Offset + (${i()}Scale * sign(${t}) * pow(abs(gl_Position), vec4(${i()}Exp)))`;return e.vertexShader().appendBody(`${t} = (${i()}Include * (${a})) + ((1.0 - ${i()}Include) * ${t});`),l},l.exponent=(...e)=>e.length?(n=e[0],l):n,j(l,a),l},Ge=e=>{let t=G.scaleIdentity(),a=null;const n=e.copy.toString();return n===G.scaleLinear().copy.toString()?a=Qe().domain(e.domain()):n===G.scaleLog().copy.toString()?a=Fe().domain(e.domain()).base(e.base()):n===G.scalePow().copy.toString()?a=Ye().domain(e.domain()).exponent(e.exponent()):n===G.scaleTime().copy.toString()?a=Qe().domain(e.domain()):(a=Qe().domain(e.range()),t=e),{scale:t,glScale:a}};const Me={header:`attribute vec4 aColor;
             varying vec4 vColor;`,body:`vColor = aColor;`},Ue={header:`attribute float aXValue;
             attribute float aYValue;
             attribute float aSize;
             uniform float uLineWidth;
             varying float vSize;`,body:`vSize = 2.0 * sqrt(aSize / 3.14159);
           gl_PointSize = vSize + uLineWidth + 1.0;
           gl_Position = vec4(aXValue, aYValue, 0, 1);`},Xe={header:`attribute float aXValue;
        attribute float aYValue;
        attribute float aSize;
        uniform float uLineWidth;
        varying float vSize;`,body:`vSize = sqrt(aSize);
        gl_PointSize = vSize + uLineWidth + 1.0;
        gl_Position = vec4(aXValue, aYValue, 0, 1);`},qe={header:`attribute float aXValue;
        attribute float aYValue;
        attribute float aSize;
        uniform float uLineWidth;
        varying float vSize;`,body:`vSize = sqrt((16.0 * aSize) / (3.0 * sqrt(3.0)));
        gl_PointSize = vSize + uLineWidth + 1.0;
        gl_Position = vec4(aXValue, aYValue, 0, 1);`},je={header:`attribute float aXValue;
        attribute float aYValue;
        attribute float aSize;
        uniform float uStrokeWidth;
        varying float vSize;
        varying float vStrokeWidthRatio;`,body:`vSize = 3.0 * sqrt(aSize / 5.0);
        vStrokeWidthRatio = uStrokeWidth / (vSize + uStrokeWidth + 1.0);
        gl_PointSize = vSize + uStrokeWidth + 1.0;
        gl_Position = vec4(aXValue, aYValue, 0, 1);`},Ke={header:`attribute float aXValue;
        attribute float aYValue;
        attribute float aXDirection;
        attribute float aYDirection;
        attribute float aBandwidth;
        attribute float aColorIndicator;
        varying float vColorIndicator;
        uniform vec2 uScreen;
        uniform float uLineWidth;`,body:`vColorIndicator = aColorIndicator;
    gl_Position = vec4(aXValue, aYValue, 0, 1);`},Ze={header:`attribute float aXValue;
        attribute float aYValue;
        attribute float aWidthValue;
        attribute float aDirection;`,body:`gl_Position = vec4(aXValue, aYValue, 0, 1);
        vec4 origin = vec4(0.0, 0.0, 0.0, 0.0);
        vec4 width = vec4(aWidthValue, 0.0, 0.0, 0.0);
        gl_Position.x += (width.x - origin.x) / 2.0 * aDirection;`},Je={header:`uniform float uLineWidth; // defines the width of the line
        uniform vec2 uScreen; // the screen space canvas size (for normalizing vectors)
        attribute vec2 aCorner; // defines which vertex in the line join we are considering
        attribute float aXValue; attribute float aYValue; // the current vertex positions
        attribute float aNextXValue; attribute float aNextYValue; // the next vertex positions
        attribute float aPrevXValue; attribute float aPrevYValue; // the previous vertex positions
        attribute float aDefined;
        varying float vDefined;`,body:`vDefined = aDefined;
        vec4 curr = vec4(aXValue, aYValue, 0, 1);
        gl_Position = curr;
        vec4 next = vec4(aNextXValue, aNextYValue, 0, 0);
        vec4 prev = vec4(aPrevXValue, aPrevYValue, 0, 0);`},$e={body:`if (all(equal(gl_Position.xy, prev.xy))) {
            prev.xy = gl_Position.xy + normalize(gl_Position.xy - next.xy);
        }
        if (all(equal(gl_Position.xy, next.xy))) {
            next.xy = gl_Position.xy + normalize(gl_Position.xy - prev.xy);
        }
        vec2 A = normalize(normalize(gl_Position.xy - prev.xy) * uScreen);
        vec2 B = normalize(normalize(next.xy - gl_Position.xy) * uScreen);
        vec2 tangent = normalize(A + B);
        vec2 miter = vec2(-tangent.y, tangent.x);
        vec2 normalA = vec2(-A.y, A.x);
        float miterLength = 1.0 / dot(miter, normalA);
        vec2 point = normalize(A - B);
        if (miterLength > 10.0 && sign(aCorner.x * dot(miter, point)) > 0.0) {
            gl_Position.xy = gl_Position.xy - (aCorner.x * aCorner.y * uLineWidth * normalA) / uScreen.xy;
        } else {
            gl_Position.xy = gl_Position.xy + (aCorner.x * miter * uLineWidth * miterLength) / uScreen.xy;
        }`},et={header:`attribute float aXValue;
        attribute float aYValue;
        attribute float aXDirection;
        attribute float aYDirection;
        attribute float aBandwidth;
        uniform vec2 uScreen;
        uniform float uLineWidth;`,body:`gl_Position = vec4(aXValue, aYValue, 0, 1);`},tt={header:`attribute float aXValue;
        attribute float aYValue;
        attribute float aXPrevValue;
        attribute float aYPrevValue;
        attribute float aY0Value;
        attribute float aY0PrevValue;
        attribute vec3 aCorner;
        attribute float aDefined;
        varying float vDefined;
        
        float when_lt(float a, float b) {
            return max(sign(b - a), 0.0);
        }
        
        float and(float a, float b) {
            return a * b;
        }`,body:`vDefined = aDefined;
        gl_Position = vec4(0, 0, 0, 1);

        float hasIntercepted = when_lt((aYValue - aY0Value) * (aYPrevValue - aY0PrevValue), 0.0);
        float useIntercept = and(aCorner.z, hasIntercepted);
        
        float yGradient = (aYValue - aYPrevValue) / (aXValue - aXPrevValue);
        float yConstant = aYValue - (yGradient * aXValue);

        float y0Gradient = (aY0Value - aY0PrevValue) / (aXValue - aXPrevValue);
        float y0Constant = aY0Value - (y0Gradient * aXValue);

        float denominator = (yGradient - y0Gradient) + step(abs(yGradient - y0Gradient), 0.0);
        float interceptXValue = (y0Constant - yConstant) / denominator;
        float interceptYValue = (yGradient * interceptXValue) + yConstant;

        gl_Position = vec4(interceptXValue * useIntercept, interceptYValue * useIntercept, 0, 1);
        
        gl_Position.x += (1.0 - useIntercept) * ((aCorner.x * aXValue) + ((1.0 - aCorner.x) * aXPrevValue));
        gl_Position.y += (1.0 - useIntercept) * (1.0 - aCorner.y) * ((aCorner.x * aYValue) + ((1.0 - aCorner.x) * aYPrevValue));
        gl_Position.y += (1.0 - useIntercept) * aCorner.y * ((aCorner.x * aY0Value) + ((1.0 - aCorner.x) * aY0PrevValue));`},at={header:`attribute float aXValue;
        attribute float aYValue;
        attribute float aXDirection;
        attribute float aYDirection;
        attribute float aBandwidth;
        uniform vec2 uScreen;
        uniform float uLineWidth;`,body:`gl_Position = vec4(aXValue, aYValue, 0, 1);`};var nt=Object.freeze({scale:{header:`uniform vec2 uScale;`,body:`gl_Position.xy = gl_Position.xy * uScale;`},translate:{header:`uniform vec2 uTranslate;`,body:`gl_Position.xy = gl_Position.xy + uTranslate;`},multiColor:Me,circle:Ue,square:Xe,triangle:qe,cross:je,rect:Ke,bar:Ze,preScaleLine:Je,postScaleLine:$e,errorBar:et,area:tt,boxPlot:at});const it={header:`varying float vSize;`,body:`float distance = length(2.0 * gl_PointCoord - 1.0);
    if (distance > 1.0) {
        discard;
        return;
    }`},lt={header:`varying float vSize;`,body:`vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
        float distance = max(abs(pointCoordTransform.x), abs(pointCoordTransform.y));`},rt={header:`varying float vSize;`,body:`vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
    float topEdgesDistance = abs(pointCoordTransform.x) - ((pointCoordTransform.y - 0.6) / sqrt(3.0));
    float bottomEdgeDistance = pointCoordTransform.y + 0.5;
    float distance = max(topEdgesDistance, bottomEdgeDistance);
    if (distance > 1.0) {
        discard;
    }`},dt={header:`varying float vSize;
            varying float vStrokeWidthRatio;`,body:`vec2 pointCoordTransform = 2.0 * gl_PointCoord - 1.0;
    float innerCornerDistance = min(abs(pointCoordTransform.x), abs(pointCoordTransform.y)) + 0.66 - vStrokeWidthRatio;
    float outerEdgeDistance = max(abs(pointCoordTransform.x), abs(pointCoordTransform.y));
    float distance = max(innerCornerDistance, outerEdgeDistance);
    if (distance > 1.0) {
        discard;
    }`},ot={header:`varying float vColorIndicator;`,body:`gl_FragColor = vec4(0.4, 0.8, 0, 1);
    if (vColorIndicator < 0.0) {
        gl_FragColor = vec4(0.8, 0.4, 0, 1);
    }`},st={header:`varying float vDefined;`,body:`if (vDefined < 0.5) {
            discard;
        }
        gl_FragColor = vec4(0.86, 0.86, 0.86, 1);`},ct={body:`gl_FragColor.a = gl_FragColor.a * (1.0 - smoothstep(vSize - 2.0, vSize, distance * vSize));`},ht={header:`varying vec4 vColor;`,body:`gl_FragColor = vColor;`},gt={header:`uniform vec4 uColor;`,body:`gl_FragColor = uColor;`},ut={header:`uniform vec4 uEdgeColor;
             uniform float uLineWidth;`,body:`float sEdge = smoothstep(vSize - uLineWidth - 2.0, vSize - uLineWidth, distance * (vSize + uLineWidth));
           gl_FragColor = (uEdgeColor * sEdge) + ((1.0 - sEdge) * gl_FragColor);`},mt={header:`varying float vDefined;`,body:`if (vDefined < 0.5) {
        discard;
    }`};var ft=Object.freeze({circle:it,square:lt,triangle:rt,cross:dt,rect:ot,area:st,pointAlias:ct,multiColor:ht,seriesColor:gt,pointEdge:ut,line:mt}),pt=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(Ue.header).appendBody(Ue.body),t.appendHeader(it.header).appendBody(it.body),{vertex:()=>e,fragment:()=>t}},yt=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(Xe.header).appendBody(Xe.body),t.appendHeader(lt.header).appendBody(lt.body),{vertex:()=>e,fragment:()=>t}},xt=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(qe.header).appendBody(qe.body),t.appendHeader(rt.header).appendBody(rt.body),{vertex:()=>e,fragment:()=>t}},vt=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(je.header).appendBody(je.body),t.appendHeader(dt.header).appendBody(dt.body),{vertex:()=>e,fragment:()=>t}},bt=e=>{switch(e){case M.symbolCircle:return pt();case M.symbolSquare:return yt();case M.symbolTriangle:return xt();case M.symbolCross:return vt();default:throw new Error(`Unrecognised symbol: ${e}`);}},St=()=>{let e=1;const t=t=>{t.buffers().uniform("uLineWidth",Ce(e))};return t.lineWidth=(...a)=>a.length?(e=a[0],t):e,t},wt=()=>{let e=We(),t=We(),a=pt(),n=()=>{};const i=Le().value((e,t)=>e[t]),l=Le().value((e,t)=>e[t]),r=Le().value((e,t)=>e[t]),d=Ne().mode(He.POINTS);d.buffers().attribute("aXValue",i).attribute("aYValue",l).attribute("aSize",r);const o=i=>{d.vertexShader(a.vertex()).fragmentShader(a.fragment()),e.coordinate(0),e(d),t.coordinate(1),t(d),n(d),d(i)};return o.xValues=e=>(i.data(e),o),o.yValues=e=>(l.data(e),o),o.sizes=e=>(r.data(e),o),o.decorate=(...e)=>e.length?(n=e[0],o):n,o.xScale=(...t)=>t.length?(e=t[0],o):e,o.yScale=(...e)=>e.length?(t=e[0],o):t,o.type=(...e)=>e.length?(a=e[0],o):a,X(o,d,"context"),o},Vt=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(Je.header).appendBody(Je.body),t.appendHeader(mt.header).appendBody(mt.body),{vertex:()=>e,fragment:()=>t}},kt=()=>{let e=We(),t=We(),a=()=>{};const n=St(),i=Le().value((e,t)=>e[t]),l=Le().value((e,t)=>e[N(t+1,e.length-1)]),r=Le().value((e,t)=>e[F(t-1,0)]),d=Le().value((e,t)=>e[t]),o=Le().value((e,t)=>e[N(t+1,e.length-1)]),s=Le().value((e,t)=>e[F(t-1,0)]),c=Le().size(2).data([[-1,-1],[1,-1],[-1,1],[1,1]]).value((e,t,a,n)=>e[a][n]),h=Le().value((e,t,a)=>{const n=e[t];if(1>=a){const a=0===t?n:e[t-1];return n?a:n}else{const a=t===e.length-1?n:e[t+1];return n?a:n}}),g=Ne().mode(He.TRIANGLE_STRIP).verticesPerElement(4);g.buffers().attribute("aXValue",i).attribute("aNextXValue",l).attribute("aPrevXValue",r).attribute("aYValue",d).attribute("aNextYValue",o).attribute("aPrevYValue",s).attribute("aCorner",c).attribute("aDefined",h);const u=i=>{const l=Vt();g.vertexShader(l.vertex()).fragmentShader(l.fragment()),e.coordinate(0),e(g),t.coordinate(1),t(g),e.scaleComponent(g,"next"),t.scaleComponent(g,"next"),e.scaleComponent(g,"prev"),t.scaleComponent(g,"prev"),g.vertexShader().appendBody($e.body),n(g),a(g),g(i)};return u.xValues=e=>(i.data(e),l.data(e),r.data(e),u),u.yValues=e=>(d.data(e),o.data(e),s.data(e),u),u.defined=e=>(h.data(e),u),u.decorate=(...e)=>e.length?(a=e[0],u):a,u.xScale=(...t)=>t.length?(e=t[0],u):e,u.yScale=(...e)=>e.length?(t=e[0],u):t,X(u,g,"context"),X(u,n,"lineWidth"),u},At=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(Ke.header).appendBody(Ke.body),t.appendHeader(ot.header).appendBody(ot.body),{vertex:()=>e,fragment:()=>t}},Et=()=>{const e=Ne().verticesPerElement(18);let t=We(),a=We();const n=St();let i=()=>{};const l=Le().value((e,t)=>e[t]),r=Le().data({open:null,high:null,low:null,close:null}).value((e,t,a)=>{if([6,7,8,9,10,11].includes(a))return e.open[t];if([2,4,5].includes(a))return e.high[t];if([0,1,3].includes(a))return e.low[t];if([12,13,14,15,16,17].includes(a))return e.close[t];throw new Error(`Invalid vertex ${a}`)}),d=Le().data([1,-1,-1,1,1,-1,0,0,-1,0,-1,-1,0,0,1,0,1,1]).value((e,t,a)=>e[a]),o=Le().data([0,0,0,0,0,0,1,-1,-1,1,1,-1,-1,1,1,-1,-1,1]).value((e,t,a)=>e[a]),s=Le().value((e,t,a)=>{if([8,10,11,14,16,17].includes(a)){const n=e[t];return[8,10,11].includes(a)?-n:n}return 0}),c=Le().value((e,t)=>{const a=e.open[t],n=e.close[t];return a<n?1:-1}),h=h=>{const g=At();e.vertexShader(g.vertex()).fragmentShader(g.fragment()).mode(He.TRIANGLES),e.buffers().attribute("aXValue",l).attribute("aYValue",r).attribute("aXDirection",d).attribute("aYDirection",o).attribute("aBandwidth",s).attribute("aColorIndicator",c),t.coordinate(0),t(e),a.coordinate(1),a(e),n(e),e.vertexShader().appendBody(`
        gl_Position.x += ((uLineWidth * aXDirection / 2.0) + (aBandwidth / 2.0)) / uScreen.x;
        gl_Position.y += (uLineWidth * aYDirection / 2.0) / uScreen.y;
      `),i(e),e(h)};return h.xValues=e=>(l.data(e),h),h.openValues=e=>{const t=r.data(),a={...t,open:e};return r.data(a),c.data(a),h},h.highValues=e=>{const t=r.data(),a={...t,high:e};return r.data(a),c.data(a),h},h.lowValues=e=>{const t=r.data(),a={...t,low:e};return r.data(a),c.data(a),h},h.closeValues=e=>{const t=r.data(),a={...t,close:e};return r.data(a),c.data(a),h},h.bandwidth=e=>(s.data(e),h),h.decorate=(...e)=>e.length?(i=e[0],h):i,h.xScale=(...e)=>e.length?(t=e[0],h):t,h.yScale=(...e)=>e.length?(a=e[0],h):a,X(h,e,"context"),X(h,n,"lineWidth"),h},It=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(Ze.header).appendBody(Ze.body),{vertex:()=>e,fragment:()=>t}},Tt=()=>{const e=Ne().verticesPerElement(6);let t=null,a=null,n=()=>{};const i=Le().value((e,t)=>e[t]),l=Le().data([null,null]).value((e,t,a)=>{const n=[1,2,4].includes(a)?0:1;return e[n][t]}),r=Le().value((e,t)=>e[t]),d=Le().size(2).data([-1,-1,1,-1,1,1]).value((e,t,a)=>e[a]),o=o=>{const s=It();e.vertexShader(s.vertex()).fragmentShader(s.fragment()).mode(He.TRIANGLES),e.buffers().attribute("aXValue",i).attribute("aYValue",l).attribute("aWidthValue",r).attribute("aDirection",d),t.coordinate(0),t(e),a.coordinate(1),a(e),t.scaleComponent(e,"origin"),t.scaleComponent(e,"width"),n(e),e(o)};return o.xScale=(...e)=>e.length?(t=e[0],o):t,o.yScale=(...e)=>e.length?(a=e[0],o):a,o.decorate=(...e)=>e.length?(n=e[0],o):n,o.xValues=e=>(i.data(e),o),o.y0Values=e=>(l.data([e,l.data()[1]]),o),o.yValues=e=>(l.data([l.data()[0],e]),o),o.widths=e=>(r.data(e),o),X(o,e,"context"),o},_t=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(et.header).appendBody(et.body),{vertex:()=>e,fragment:()=>t}},Pt=()=>{const e=Ne().verticesPerElement(18);let t=We(),a=We();const n=St(),i=Le().value((e,t)=>e[t]),l=Le().data({high:null,low:null}).value((e,t,a)=>[2,4,5,6,7,8,9,10,11].includes(a)?e.high[t]:[0,1,3,12,13,14,15,16,17].includes(a)?e.low[t]:0),r=Le().data([1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,1,-1,1,1]).value((e,t,a)=>e[a]),d=Le().data([0,0,0,0,0,0,1,-1,-1,1,1,-1,-1,1,1,-1,-1,1]).value((e,t,a)=>e[a]),o=Le().value((e,t,a)=>{if(5<a){const n=e[t];return[8,10,11,12,13,15].includes(a)?-n:n}return 0}),s=s=>{const c=_t();e.vertexShader(c.vertex()).fragmentShader(c.fragment()).mode(He.TRIANGLES),e.buffers().attribute("aXValue",i).attribute("aYValue",l).attribute("aXDirection",r).attribute("aYDirection",d).attribute("aBandwidth",o),t.coordinate(0),t(e),a.coordinate(1),a(e),n(e),e.vertexShader().appendBody(`
                gl_Position.x += ((uLineWidth * aXDirection) + aBandwidth) / uScreen.x;
                gl_Position.y += (uLineWidth * aYDirection) / uScreen.y;
            `),e(s)};return s.xValues=e=>(i.data(e),s),s.highValues=e=>{const t=l.data();return l.data({...t,high:e}),s},s.lowValues=e=>{const t=l.data();return l.data({...t,low:e}),s},s.bandwidth=e=>(o.data(e),s),s.xScale=(...e)=>e.length?(t=e[0],s):t,s.yScale=(...e)=>e.length?(a=e[0],s):a,X(s,e,"context"),X(s,n,"lineWidth"),s},Bt=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(tt.header).appendBody(tt.body),t.appendHeader(st.header).appendBody(st.body),{vertex:()=>e,fragment:()=>t}},zt=()=>{let e=We(),t=We(),a=()=>{};const n=Le().value((e,t)=>e[N(t+1,e.length-1)]),i=Le().value((e,t)=>e[t]),l=Le().value((e,t)=>e[N(t+1,e.length-1)]),r=Le().value((e,t)=>e[t]),d=Le().value((e,t)=>e[N(t+1,e.length-1)]),o=Le().value((e,t)=>e[t]),s=Le().size(3).data([[0,0,0],[0,1,0],[1,1,1],[0,0,1],[1,0,0],[1,1,0]]).value((e,t,a,n)=>e[a][n]),c=Le().value((e,t)=>{const a=e[t],n=t===e.length-1?0:e[t+1];return a?n:a}),h=Ne().mode(He.TRIANGLES).verticesPerElement(6);h.buffers().attribute("aXValue",n).attribute("aXPrevValue",i).attribute("aYValue",l).attribute("aYPrevValue",r).attribute("aY0Value",d).attribute("aY0PrevValue",o).attribute("aCorner",s).attribute("aDefined",c);const g=n=>{const i=Bt();h.vertexShader(i.vertex()).fragmentShader(i.fragment()),e.coordinate(0),e(h),t.coordinate(1),t(h),a(h),h(n-1)};return g.xValues=e=>(n.data(e),i.data(e),g),g.yValues=e=>(l.data(e),r.data(e),g),g.y0Values=e=>(d.data(e),o.data(e),g),g.defined=e=>(c.data(e),g),g.decorate=(...e)=>e.length?(a=e[0],g):a,g.xScale=(...t)=>t.length?(e=t[0],g):e,g.yScale=(...e)=>e.length?(t=e[0],g):t,X(g,h,"context"),g},Lt=()=>{const e=Ne().verticesPerElement(12);let t=We(),a=We();const n=St();let i=()=>{};const l=Le().value((e,t)=>e[t]),r=Le().data({open:null,high:null,low:null,close:null}).value((e,t,a)=>[6,7,9].includes(a)?e.open[t]:[2,4,5].includes(a)?e.high[t]:[0,1,3].includes(a)?e.low[t]:[8,10,11].includes(a)?e.close[t]:0),d=Le().data([1,-1,-1,1,1,-1,1,-1,-1,1,1,-1]).value((e,t,a)=>e[a]),o=Le().value((e,t,a)=>{const n=e.open[t],i=e.close[t];if([6,7,8,9,10,11].includes(a)){const e=N(n,i)===n;return[6,7,9].includes(a)?e?-1:1:e?1:-1}return 0}),s=Le().value((e,t,a)=>{if(6<=a&&11>=a){const n=e[t];return[6,9,10].includes(a)?n:-n}return 0}),c=Le().value((e,t)=>{const a=e.open[t],n=e.close[t];return a<n?1:-1}),h=h=>{const g=At();e.vertexShader(g.vertex()).fragmentShader(g.fragment()).mode(He.TRIANGLES),e.buffers().attribute("aXValue",l).attribute("aYValue",r).attribute("aXDirection",d).attribute("aYDirection",o).attribute("aBandwidth",s).attribute("aColorIndicator",c),t.coordinate(0),t(e),a.coordinate(1),a(e),n(e),e.vertexShader().appendBody(`
        gl_Position.x += ((uLineWidth * aXDirection / 2.0) + (aBandwidth / 2.0)) / uScreen.x;
        gl_Position.y += (uLineWidth * aYDirection / 2.0) / uScreen.y;
      `),i(e),e(h)};return h.xValues=e=>(l.data(e),h),h.openValues=e=>{const t=r.data(),a={...t,open:e};return r.data(a),o.data(a),c.data(a),h},h.highValues=e=>{const t=r.data(),a={...t,high:e};return r.data(a),o.data(a),c.data(a),h},h.lowValues=e=>{const t=r.data(),a={...t,low:e};return r.data(a),o.data(a),c.data(a),h},h.closeValues=e=>{const t=r.data(),a={...t,close:e};return r.data(a),o.data(a),c.data(a),h},h.bandwidth=e=>(s.data(e),h),h.decorate=(...e)=>e.length?(i=e[0],h):i,h.xScale=(...e)=>e.length?(t=e[0],h):t,h.yScale=(...e)=>e.length?(a=e[0],h):a,X(h,e,"context"),X(h,n,"lineWidth"),h},Ct=()=>{const e=De(Re),t=De(Oe);return e.appendHeader(at.header).appendBody(at.body),{vertex:()=>e,fragment:()=>t}},Dt=()=>{const e=Ne().verticesPerElement(54);let t=We(),a=We();const n=St(),i=Le().value((e,t)=>e[t]),l=Le().data({median:null,upperQuartile:null,lowerQuartile:null,high:null,low:null}).value((e,t,a)=>[18,19,20,21,22,23].includes(a)?e.median[t]:[8,10,11,12,13,14,15,16,17,30,31,33,36,37,39].includes(a)?e.upperQuartile[t]:[24,25,26,27,28,29,32,34,35,38,40,41,42,43,45].includes(a)?e.lowerQuartile[t]:[0,1,2,3,4,5,6,7,9].includes(a)?e.high[t]:[44,46,47,48,49,50,51,52,53].includes(a)?e.low[t]:0),r=Le().data([0,0,0,0,0,0,-1,1,1,-1,-1,1,1,-1,-1,1,1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,-1,1,-1,1,1,-1,-1,1,-1,1,1,-1,-1,1,0,0,0,0,0,0]).value((e,t,a)=>e[a]),d=Le().data([1,1,-1,1,-1,-1,-1,-1,1,-1,1,1,1,1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,1,-1,1,-1,-1,-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]).value((e,t,a)=>e[a]),o=Le().data({bandwidth:null,capWidth:null}).value((e,t,a)=>{if(5>=a||48<=a){const n=e.capWidth[t];return[0,3,4,48,51,52].includes(a)?-n:n}if(11<a&&42>a){const n=e.bandwidth[t];return[12,15,16,18,21,22,24,27,28,30,31,32,33,34,35].includes(a)?-n:n}return 0}),s=s=>{const c=Ct();e.vertexShader(c.vertex()).fragmentShader(c.fragment()).mode(He.TRIANGLES),e.buffers().attribute("aXValue",i).attribute("aYValue",l).attribute("aXDirection",r).attribute("aYDirection",d).attribute("aBandwidth",o),t.coordinate(0),t(e),a.coordinate(1),a(e),n(e),e.vertexShader().appendBody(`
                gl_Position.x += ((uLineWidth * aXDirection) + aBandwidth) / uScreen.x;
                gl_Position.y += (uLineWidth * aYDirection) / uScreen.y;
            `),e(s)};return s.xValues=e=>(i.data(e),s),s.medianValues=e=>{const t=l.data();return l.data({...t,median:e}),s},s.upperQuartileValues=e=>{const t=l.data();return l.data({...t,upperQuartile:e}),s},s.lowerQuartileValues=e=>{const t=l.data();return l.data({...t,lowerQuartile:e}),s},s.highValues=e=>{const t=l.data();return l.data({...t,high:e}),s},s.lowValues=e=>{const t=l.data();return l.data({...t,low:e}),s},s.bandwidth=e=>{const t=o.data();return o.data({...t,bandwidth:e}),s},s.capWidth=e=>{const t=o.data();return o.data({...t,capWidth:e}),s},s.xScale=(...e)=>e.length?(t=e[0],s):t,s.yScale=(...e)=>e.length?(a=e[0],s):a,X(s,e,"context"),X(s,n,"lineWidth"),s},Rt=()=>{const e=s.symbol(),t=Ee(),a=he("g","point"),n=e=>"translate("+e[0]+", "+e[1]+")",i=i=>{i.selection&&a.transition(i),i.each((i,l,r)=>{const d=i.filter(t.defined()),s=a(o.select(r[l]),d);s.enter().attr("transform",(e,a)=>n(t.values(e,a).origin)).attr("fill",Ie.gray).attr("stroke",Ie.black).append("path"),s.attr("transform",(e,a)=>n(t.values(e,a).origin)).select("path").attr("d",e),t.decorate()(s,i,l)})};return j(i,t,Z("baseValue","bandwidth","align")),X(i,a,"key"),X(i,e,"type","size"),i},Ot=()=>{const e=s.symbol(),t=Ee(),a=a=>{const n=a.filter(t.defined()),l=e.context();n.forEach((a,n)=>{l.save();const i=t.values(a,n);l.translate(i.origin[0],i.origin[1]),l.beginPath(),e(a,n),l.strokeStyle=Ie.black,l.fillStyle=Ie.gray,t.decorate()(l,a,n),l.fill(),l.stroke(),l.closePath(),l.restore()})};return j(a,t,Z("baseValue","bandwidth","align")),X(a,e,"size","type","context"),a},Ht=()=>{let e=e=>e.high,t=e=>e.low,n=e=>e.cross,l="vertical",r="center",o=()=>5;const s=Ae({decorate:()=>{},defined:(a,l)=>R(t,e,n)(a,l),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return s.values=(a,d)=>{const i=o(a,d),c=ke(r,i),h=s.xScale(),g=s.yScale();if("vertical"===l){const l=g(e(a,d));return{origin:[h(n(a,d))+c,l],high:0,low:g(t(a,d))-l,width:i}}else{const l=h(t(a,d));return{origin:[l,g(n(a,d))+c],high:h(e(a,d))-l,low:0,width:i}}},s.xValues=()=>"vertical"===l?[n]:[e,t],s.yValues=()=>"vertical"===l?[e,t]:[n],s.orient=(...e)=>e.length?(l=e[0],s):l,s.lowValue=(...e)=>e.length?(t=Ve(e[0]),s):t,s.highValue=(...t)=>t.length?(e=Ve(t[0]),s):e,s.crossValue=(...e)=>e.length?(n=Ve(e[0]),s):n,s.bandwidth=(...e)=>e.length?(o=Ve(e[0]),s):o,s.align=(...e)=>e.length?(r=e[0],s):r,s},Nt=()=>{let e,t=e=>e.date,n=e=>e.open,l=e=>e.high,r=e=>e.low,o=e=>e.close,s=()=>5,c="center",h=(a,n)=>e.xScale()(t(a,n));return e=Ae({decorate:()=>{},defined:(e,a)=>R(t,n,r,l,o)(e,a),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()}),e.values=(t,a)=>{const i=o(t,a),d=n(t,a),g=s(t,a),u=ke(c,g);let m="";return i>d?m="up":i<d&&(m="down"),{cross:h(t,a)+u,open:e.yScale()(d),high:e.yScale()(l(t,a)),low:e.yScale()(r(t,a)),close:e.yScale()(i),width:g,direction:m}},e.xValues=()=>[t],e.yValues=()=>[n,l,r,o],e.crossValue=(...a)=>a.length?(t=a[0],e):t,e.openValue=(...t)=>t.length?(n=t[0],e):n,e.highValue=(...t)=>t.length?(l=t[0],e):l,e.lowValue=(...t)=>t.length?(r=t[0],e):r,e.yValue=e.closeValue=(...t)=>t.length?(o=t[0],e):o,e.bandwidth=(...t)=>t.length?(s=Ve(t[0]),e):s,e.align=(...t)=>t.length?(c=t[0],e):c,e},Wt=(e,t)=>{const a=Nt(),n=he("g",t),l=e=>"translate("+e.cross+", "+e.high+")",r=e=>t=>e.selection?t.transition(e):t,d=i=>{i.selection&&n.transition(i);const s=r(i);i.each((i,r,d)=>{const c=i.filter(a.defined()),h=n(o.select(d[r]),c);h.enter().attr("transform",(e,t)=>l(a.values(e,t))+" scale(1e-6, 1)").append("path"),h.each((n,r,i)=>{const d=a.values(n,r),c="up"===d.direction?Ie.green:Ie.red,h=s(o.select(i[r])).attr("class",t+" "+d.direction).attr("stroke",c).attr("fill",c).attr("transform",()=>l(d)+" scale(1)");e.x(0).width(d.width).open(()=>d.open-d.high).high(0).low(()=>d.low-d.high).close(()=>d.close-d.high),h.select("path").attr("d",e([n]))}),a.decorate()(h,i,r)})};return X(d,n,"key"),j(d,a),d},Qt=e=>{const t=Nt(),a=a=>{const n=a.filter(t.defined()),l=e.context();n.forEach((a,n)=>{l.save();const i=t.values(a,n);l.translate(i.cross,i.high),l.beginPath(),e.x(0).open(()=>i.open-i.high).width(i.width).high(0).low(()=>i.low-i.high).close(()=>i.close-i.high)([a]);const r="up"===i.direction?Ie.green:Ie.red;l.strokeStyle=r,l.fillStyle=r,t.decorate()(l,a,n),l.fill(),l.stroke(),l.closePath(),l.restore()})};return X(a,e,"context"),j(a,t),a},Ft=e=>{const t=Nt(),a=a=>{const n=a.filter(t.defined()),l=Ge(t.xScale()),r=Ge(t.yScale()),o=new Float32Array(n.length),s=new Float32Array(n.length),c=new Float32Array(n.length),h=new Float32Array(n.length),g=new Float32Array(n.length),u=new Float32Array(n.length);n.forEach((e,a)=>{o[a]=l.scale(t.crossValue()(e,a)),s[a]=r.scale(t.openValue()(e,a)),c[a]=r.scale(t.highValue()(e,a)),h[a]=r.scale(t.lowValue()(e,a)),g[a]=r.scale(t.closeValue()(e,a)),u[a]=t.bandwidth()(e,a)}),e.xValues(o).openValues(s).highValues(c).lowValues(h).closeValues(g).bandwidth(u).xScale(l.glScale).yScale(r.glScale).decorate(e=>t.decorate()(e,n,0)),e(n.length)};return j(a,t,Z("align")),X(a,e,"context","lineWidth"),a},Yt=()=>{let e=e=>e.upperQuartile,t=e=>e.lowerQuartile,n=e=>e.high,l=e=>e.low,r=e=>e.value,o=e=>e.median,s="vertical",c="center",h=()=>5;const g=Ae({decorate:()=>{},defined:(a,d)=>R(l,n,t,e,r,o)(a,d),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return g.values=(a,d)=>{const i=h(a,d),u=ke(c,i),m=g.xScale(),f=g.yScale();if("vertical"===s){const s=f(n(a,d));return{origin:[m(r(a,d))+u,s],high:0,upperQuartile:f(e(a,d))-s,median:f(o(a,d))-s,lowerQuartile:f(t(a,d))-s,low:f(l(a,d))-s,width:i}}else{const s=m(l(a,d));return{origin:[s,f(r(a,d))+u],high:m(n(a,d))-s,upperQuartile:m(e(a,d))-s,median:m(o(a,d))-s,lowerQuartile:m(t(a,d))-s,low:0,width:i}}},g.xValues=()=>"vertical"===s?[r]:[e,t,n,l,o],g.yValues=()=>"vertical"===s?[e,t,n,l,o]:[r],g.orient=(...e)=>e.length?(s=e[0],g):s,g.lowerQuartileValue=(...e)=>e.length?(t=Ve(e[0]),g):t,g.upperQuartileValue=(...t)=>t.length?(e=Ve(t[0]),g):e,g.lowValue=(...e)=>e.length?(l=Ve(e[0]),g):l,g.highValue=(...e)=>e.length?(n=Ve(e[0]),g):n,g.crossValue=(...e)=>e.length?(r=Ve(e[0]),g):r,g.medianValue=(...e)=>e.length?(o=Ve(e[0]),g):o,g.bandwidth=(...e)=>e.length?(h=Ve(e[0]),g):h,g.align=(...e)=>e.length?(c=e[0],g):c,g},Gt=()=>{let e=[],t=e=>e,n=(e,t)=>t;const i=Ae({decorate:()=>{},xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return i.xValues=()=>e.map(e=>e.xValues()).reduce((e,t)=>e.concat(t)),i.yValues=()=>e.map(e=>e.yValues()).reduce((e,t)=>e.concat(t)),i.mapping=(...e)=>e.length?(t=e[0],i):t,i.key=(...e)=>e.length?(n=e[0],i):n,i.series=(...t)=>t.length?(e=t[0],i):e,i},Mt=()=>{const e=Gt(),t=he("g"),a=he("g","multi"),n=n=>{n.selection&&(a.transition(n),t.transition(n));const i=e.mapping(),l=e.series(),r=e.xScale(),d=e.yScale();n.each((n,s,c)=>{const h=a(o.select(c[s]),l);h.each((e,a,s)=>{e.xScale(r).yScale(d);const c=i(n,a,l),h=t(o.select(s[a]),[c]);h.call(e)});const g=h.selection?h.selection():h;g.order(),e.decorate()(h,n,s)})};return j(n,e),X(n,a,"key"),n},Ut=()=>{let e=null;const t=Gt(),a=a=>{const n=t.mapping(),i=t.series(),l=t.xScale(),r=t.yScale();i.forEach((d,o)=>{const s=n(a,o,i);d.context(e).xScale(l).yScale(r);let h;d.decorate?(h=d.decorate(),d.decorate((e,n,l)=>{t.decorate()(e,a,o),h(e,n,l)})):t.decorate()(e,a,o),d(s),h&&d.decorate(h)})};return a.context=(...t)=>t.length?(e=t[0],a):e,j(a,t),a},Xt=()=>{let e=()=>50,n="center";const l=a.scaleBand(),r=Ae({decorate:()=>{},xScale:a.scaleLinear(),yScale:a.scaleLinear()});return r.offsetScaleForDatum=(a,r,d)=>{const i=e(r,d),o=ke(n,i),s=i/2;return l.domain(t.range(0,a.length)).range([-s+o,s+o])},r.bandwidth=(...t)=>t.length?(e=Ve(t[0]),r):e,r.align=(...e)=>e.length?(n=e[0],r):n,j(r,l,$({paddingInner:"paddingOuter"})),r},qt=()=>{let e="vertical",t=_e();const a=Ut(),n=n=>{"vertical"===e?a.series(n[0].map(()=>t)).mapping((e,t)=>e.map(e=>e[t])):a.series(n.map(()=>t)).mapping((e,t)=>e[t]),a(n)};return n.series=(...e)=>e.length?(t=e[0],n):t,n.orient=(...t)=>t.length?(e=t[0],n):e,j(n,a,Z("series","mapping")),n};const jt=e=>e.sort(t.ascending).filter((e,t,a)=>-1===a.indexOf(e,t+1));var Kt=()=>{let e=e=>e.x,n=e=>e.y,l=e=>e.color,r=()=>5,o=()=>5,s=a.interpolateViridis;const c=Ae({decorate:()=>{},defined:(t,a)=>R(e,n,l)(t,a),xScale:a.scaleIdentity(),yScale:a.scaleIdentity()});return c.pathGenerator=le().x(0).y(0),c.colorScale=e=>{const n=e.map(l);return a.scaleLinear().domain([t.min(n),t.max(n)])},c.values=(t,a)=>({x:c.xScale()(e(t,a)),y:c.yScale()(n(t,a)),colorValue:l(t,a),width:o(t,a),height:r(t,a)}),c.xValues=()=>[e],c.yValues=()=>[n],c.xValue=(...t)=>t.length?(e=Ve(t[0]),c):e,c.yValue=(...e)=>e.length?(n=Ve(e[0]),c):n,c.colorValue=(...e)=>e.length?(l=Ve(e[0]),c):l,c.colorInterpolate=(...e)=>e.length?(s=e[0],c):s,c.xBandwidth=(...e)=>e.length?(o=Ve(e[0]),c):o,c.yBandwidth=(...e)=>e.length?(r=Ve(e[0]),c):r,j(c,c.pathGenerator,$({horizontalAlign:"xAlign",verticalAlign:"yAlign"})),c},Zt=e=>"function"==typeof e?e:()=>e,Jt=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n=e=>e,i=n,l=()=>{},r="horizontal";const d=he("g","annotation-line"),s=a=>{if(a.selection&&d.transition(a),"horizontal"!==r&&"vertical"!==r)throw new Error("Invalid orientation");const s="horizontal"===r,c=s?(e,t)=>`translate(${e}, ${t})`:(e,t)=>`translate(${t}, ${e})`,h=s?"x2":"y2",g=s?e:t,u=s?t:e,m=s?"left-handle":"bottom-handle",f=s?"right-handle":"top-handle",p=s?"9":"0",y=s?"0":"9",x=s?"0.32em":"0.71em",v=s?"start":"middle",b=g.range(),S=(...e)=>c(b[0],u(n(...e))),w=b[1]-b[0];a.each((e,t,a)=>{const n=d(o.select(a[t]),e),s=n.enter().attr("transform",S).style("stroke","#bbb");s.append("line").attr(h,w),s.append("g").classed(m,!0).style("stroke","none"),s.append("g").classed(f,!0).style("stroke","none").attr("transform",c(w,0)).append("text").attr("text-anchor",v).attr("x",p).attr("y",y).attr("dy",x),n.attr("class",`annotation-line ${r}`),n.attr("transform",S),n.select("line").attr(h,w),n.select("g."+f).attr("transform",c(w,0)),n.select("text").text(i),l(n,e,t)})};return s.xScale=(...t)=>t.length?(e=t[0],s):e,s.yScale=(...e)=>e.length?(t=e[0],s):t,s.value=(...e)=>e.length?(n=Zt(e[0]),s):n,s.label=(...e)=>e.length?(i=Zt(e[0]),s):i,s.decorate=(...e)=>e.length?(l=e[0],s):l,s.orient=(...e)=>e.length?(r=e[0],s):r,s},$t=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n=e=>e,l=n,r=()=>{},d="horizontal";const o=s.line(),c=a=>{if("horizontal"!==d&&"vertical"!==d)throw new Error("Invalid orientation");const s="horizontal"===d,c=o.context(),h=s?e:t,g=s?t:e,u=h.domain(),m=s?9:0,f=s?0:9,p=s?"left":"center",v=s?"middle":"hanging";a.forEach((e,t)=>{c.save(),c.beginPath(),c.strokeStyle="#bbb",c.fillStyle="#000",c.textAlign=p,c.textBaseline=v,r(c,e,t),o.context(c)(u.map(t=>{const a=[h(t),g(n(e))];return s?a:a.reverse()}));const a=s?h(u[1]):g(n(e)),i=s?g(n(e)):h(u[1]);c.fillText(l(e),a+m,i+f),c.fill(),c.stroke(),c.closePath(),c.restore()})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.value=(...e)=>e.length?(n=Zt(e[0]),c):n,c.label=(...e)=>e.length?(l=Zt(e[0]),c):l,c.decorate=(...e)=>e.length?(r=e[0],c):r,c.orient=(...e)=>e.length?(d=e[0],c):d,X(c,o,"context"),c},ea=()=>{let e=a.scaleIdentity(),t=[10],n=null;const i=()=>null==n?e.ticks?e.ticks(...t):e.domain():n;return i.scale=(...t)=>t.length?(e=t[0],i):e,i.ticks=(...e)=>(t=e,i),i.tickArguments=(...e)=>e.length?(t=e[0],i):t,i.tickValues=(...e)=>e.length?(n=e[0],i):n,i};const ta=e=>e;const aa=e=>e,na=(e,t,a={})=>{let n=[10],i=null,l=()=>{},r=null,d=6,c=6,h=3;const u=s.line(),m=he("g","tick").key(aa),f=he("path","domain"),p=()=>({offset:[0,c+h]}),y=()=>({path:[[0,0],[0,c]]}),x=a.labelOffset||p,v=a.tickPath||y,b=(e,t)=>{let a=0;return e.bandwidth&&(a=e.bandwidth()/2,e.round()&&(a=O(a))),n=>t(e(n)+a,0)},S=(e,t)=>V()?`translate(${t}, ${e})`:`translate(${e}, ${t})`,w=e=>V()?e.map(e=>[e[1],e[0]]):e,V=()=>"left"===e||"right"===e,k=(e,a,n)=>t[e]?t[e].apply(t,a):n,A=a=>{a.selection&&(m.transition(a),f.transition(a)),a.each((a,s,c)=>{const h=c[s],p=o.select(h);h.__scale__||p.attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","right"===e?"start":"left"===e?"end":"middle");const y=h.__scale__||t;h.__scale__=t.copy();const A=null==i?k("ticks",n,t.domain()):i,E=null==r?k("tickFormat",n,aa):r,I="bottom"===e||"right"===e?1:-1,T=([e,t])=>[e,I*t],_=t.range(),P=w([[_[0],I*d],[_[0],0],[_[1],0],[_[1],I*d]]),B=f(p,[a]);B.attr("d",u(P)).attr("stroke","#000");const z=m(p,A),g=A.map((e,t)=>x(e,t,A)),L=A.map((e,t)=>v(e,t,A));z.enter().attr("transform",b(y,S)).append("path").attr("stroke","#000"),z.enter().append("text").attr("transform",(e,t)=>S(...T(g[t].offset))).attr("fill","#000"),z.exit().attr("transform",b(t,S)),z.select("path").attr("visibility",(e,t)=>L[t].hidden&&"hidden").attr("d",(e,t)=>u(w(L[t].path.map(T)))),z.select("text").attr("visibility",(e,t)=>g[t].hidden&&"hidden").attr("transform",(e,t)=>S(...T(g[t].offset))).attr("dy",()=>{let t="0em";return V()?t="0.32em":"bottom"===e&&(t="0.71em"),t}).text(E),z.attr("transform",b(t,S)),l(z,a,s)})};return A.tickFormat=(...e)=>e.length?(r=e[0],A):r,A.tickSize=(...e)=>e.length?(c=d=+e[0],A):c,A.tickSizeInner=(...e)=>e.length?(c=+e[0],A):c,A.tickSizeOuter=(...e)=>e.length?(d=+e[0],A):d,A.tickPadding=(...e)=>e.length?(h=e[0],A):h,A.decorate=(...e)=>e.length?(l=e[0],A):l,A.scale=(...e)=>e.length?(t=e[0],A):t,A.ticks=(...e)=>(n=[...e],A),A.tickArguments=(...e)=>e.length?(n=null==e[0]?[]:[...e[0]],A):n.slice(),A.tickValues=(...e)=>e.length?(i=null==e[0]?[]:[...e[0]],A):i.slice(),A.orient=()=>e,A},ia=(e,t)=>{let a=!1;const n=(e,n,l)=>{let r=0,d=i.tickSizeInner()+i.tickPadding(),o=!1;if(a){const a=t(e),s=n<l.length-1?t(l[n+1]):t.range()[1];r=(s-a)/2,d=i.tickPadding(),o=n===l.length-1&&a===s}return{offset:[r,d],hidden:o}},i=na(e,t,{labelOffset:n}),l=e=>i(e);return l.tickCenterLabel=(...e)=>e.length?(a=e[0],l):a,j(l,i),l},la=e=>ia("top",e),ra=e=>ia("bottom",e),da=e=>ia("left",e),oa=e=>ia("right",e),sa=(e,t)=>{let a=null;const n=(e,a,n)=>{if(t.step)return t.step();const i=t(e);return a<n.length-1?t(n[a+1])/i:2*(t.range()[1]-i)},i=(e,t,i)=>{let r=0;return r=a?a(e,t):n(e,t,i)/2,{path:[[r,0],[r,l.tickSizeInner()]],hidden:t===i.length-1}},l=na(e,t,{labelOffset:()=>({offset:[0,l.tickPadding()]}),tickPath:i}),r=e=>{l(e)};return r.tickOffset=(...e)=>e.length?(a=e[0],r):a,j(r,l),r};var ca=e=>{return t=>{const a=e.ticks?e.ticks():e.domain(),n=t.append("text"),i=a.map(e=>n.text(e).node().getBBox()),l=F(...i.map(e=>e.height)),r=F(...i.map(e=>e.width));return n.remove(),{maxHeight:l,maxWidth:r,labelCount:a.length}}};const ha="__d3fc-elements__",ga=e=>e[ha]||{},ua=(e,t)=>void(e[ha]=t),ma=e=>delete e[ha],fa=e=>"D3FC-GROUP"===e.tagName?[e,...e.querySelectorAll("d3fc-canvas, d3fc-group, d3fc-svg")]:[e],pa=e=>{const{width:t,height:a}=ga(e),n=e.useDevicePixelRatio&&null!=global.devicePixelRatio?global.devicePixelRatio:1,i=e.clientWidth*n,l=e.clientHeight*n;ua(e,{pixelRatio:n,width:i,height:l,resized:i!==t||l!==a})};if("function"!=typeof CustomEvent)throw new Error("d3fc-element depends on CustomEvent. Make sure that you load a polyfill in older browsers. See README.");const ya=e=>{const t=ga(e),a=new CustomEvent("measure",{detail:t});e.dispatchEvent(a)},xa=e=>{const t=ga(e),a=new CustomEvent("draw",{detail:t});e.dispatchEvent(a)};var va=e=>{const t=e.map(fa).reduce((e,t)=>e.concat(t));t.forEach(pa),t.forEach(ya),t.forEach(xa)};const ba=e=>ga(e.ownerDocument).queue||[],Sa=(e,t)=>{let{requestId:a}=ga(e.ownerDocument);null==a&&(a=requestAnimationFrame(()=>{const t=ba(e);va(t),wa(e)})),ua(e.ownerDocument,{queue:t,requestId:a})},wa=e=>ma(e.ownerDocument),Va=(e,t)=>{let a=e;do if(a.parentNode===t)return!0;while(a=a.parentNode);return!1};var ka=e=>{const t=ba(e),a=-1<t.indexOf(e);if(!a){const a=t.some(t=>Va(e,t));if(!a){const a=t.filter(t=>!Va(t,e));a.push(e),Sa(e,a)}}};if("function"!=typeof HTMLElement)throw new Error("d3fc-element depends on Custom Elements (v1). Make sure that you load a polyfill in older browsers. See README.");const Aa=e=>{null!=e.__measureListener__||(e.__measureListener__=t=>e.setMeasurements(t.detail),e.addEventListener("measure",e.__measureListener__))},Ea=e=>{null==e.__measureListener__||(e.removeEventListener("measure",e.__measureListener__),e.__measureListener__=null)};var Ia=(e,t)=>class extends HTMLElement{static get observedAttributes(){return["use-device-pixel-ratio"]}attributeChangedCallback(e){"use-device-pixel-ratio"===e?this.requestRedraw():void 0}connectedCallback(){0===this.childNodes.length&&this.appendChild(e()),Aa(this)}disconnectedCallback(){Ea(this)}setMeasurements({width:e,height:a}){const{childNodes:[n,...i]}=this;if(0<i.length)throw new Error("A d3fc-svg/canvas element must only contain a single svg/canvas element.");t(this,n,{width:e,height:a})}get useDevicePixelRatio(){return this.hasAttribute("use-device-pixel-ratio")&&"false"!==this.getAttribute("use-device-pixel-ratio")}set useDevicePixelRatio(e){e&&!this.useDevicePixelRatio?this.setAttribute("use-device-pixel-ratio",""):!e&&this.useDevicePixelRatio&&this.removeAttribute("use-device-pixel-ratio"),this.requestRedraw()}requestRedraw(){ka(this)}};class Ta extends Ia(()=>document.createElement("canvas"),(e,t,{width:a,height:n})=>{if(t.setAttribute("width",a),t.setAttribute("height",n),e.setWebglViewport){const e=t.getContext("webgl");e.viewport(0,0,a,n)}}){get setWebglViewport(){return this.hasAttribute("set-webgl-viewport")&&"false"!==this.getAttribute("set-webgl-viewport")}set setWebglViewport(e){e&&!this.setWebglViewport?this.setAttribute("set-webgl-viewport",""):!e&&this.setWebglViewport&&this.removeAttribute("set-webgl-viewport"),this.requestRedraw()}}const _a=e=>{e.autoResize?Pa(e):Ba(e)},Pa=e=>{null!=e.__autoResizeListener__||(e.__autoResizeListener__=()=>ka(e),addEventListener("resize",e.__autoResizeListener__))},Ba=e=>{null==e.__autoResizeListener__||(removeEventListener("resize",e.__autoResizeListener__),e.__autoResizeListener__=null)};class za extends HTMLElement{connectedCallback(){_a(this)}disconnectedCallback(){Ba(this)}requestRedraw(){ka(this)}get autoResize(){return this.hasAttribute("auto-resize")&&"false"!==this.getAttribute("auto-resize")}set autoResize(e){e&&!this.autoResize?this.setAttribute("auto-resize",""):!e&&this.autoResize&&this.removeAttribute("auto-resize"),_a(this)}static get observedAttributes(){return["auto-resize"]}attributeChangedCallback(e){"auto-resize"===e?_a(this):void 0}}var La=Ia(()=>document.createElementNS("http://www.w3.org/2000/svg","svg"),(e,t,{width:a,height:n})=>{t.setAttribute("viewBox",`0 0 ${a} ${n}`)});const Ca=document.createElement("style");if(Ca.setAttribute("type","text/css"),document.querySelector("head").appendChild(Ca),Ca.styleSheet?Ca.styleSheet.cssText+="d3fc-canvas,d3fc-svg{position:relative;display:block}d3fc-canvas>canvas,d3fc-svg>svg{position:absolute;height:100%;width:100%}d3fc-svg>svg{overflow:visible}":Ca.textContent+="d3fc-canvas,d3fc-svg{position:relative;display:block}d3fc-canvas>canvas,d3fc-svg>svg{position:absolute;height:100%;width:100%}d3fc-svg>svg{overflow:visible}","object"!=typeof customElements||"function"!=typeof customElements.define)throw new Error("d3fc-element depends on Custom Elements (v1). Make sure that you load a polyfill in older browsers. See README.");customElements.define("d3fc-canvas",Ta),customElements.define("d3fc-group",za),customElements.define("d3fc-svg",La);var Da=(...e)=>{const t={},a=e=>{for(const a of Object.keys(t))e[a].apply(null,t[a]);return e};for(const n of e)a[n]=(...e)=>e.length?(t[n]=e,a):t[n];return a};const Ra=document.createElement("style");Ra.setAttribute("type","text/css"),document.querySelector("head").appendChild(Ra),Ra.styleSheet?Ra.styleSheet.cssText+="d3fc-group.cartesian-chart{width:100%;height:100%;overflow:hidden;display:grid;display:-ms-grid;grid-template-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);grid-template-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);}\nd3fc-group.cartesian-chart>.top-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:1;-ms-grid-row:1;}\nd3fc-group.cartesian-chart>.top-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:2;-ms-grid-row:2;}\nd3fc-group.cartesian-chart>.left-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:1;-ms-grid-column:1;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.left-axis{width:3em;grid-column:2;-ms-grid-column:2;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.plot-area{overflow:hidden;grid-column:3;-ms-grid-column:3;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-axis{width:3em;grid-column:4;-ms-grid-column:4;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:5;-ms-grid-column:5;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.bottom-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:4;-ms-grid-row:4;}\nd3fc-group.cartesian-chart>.bottom-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:5;-ms-grid-row:5;}\nd3fc-group.cartesian-chart>.y-label{display:flex;transform:rotate(-90deg);width:1em;white-space:nowrap;justify-content:center;}":Ra.textContent+="d3fc-group.cartesian-chart{width:100%;height:100%;overflow:hidden;display:grid;display:-ms-grid;grid-template-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-columns:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);grid-template-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);-ms-grid-rows:minmax(1em,max-content) auto 1fr auto minmax(1em,max-content);}\nd3fc-group.cartesian-chart>.top-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:1;-ms-grid-row:1;}\nd3fc-group.cartesian-chart>.top-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:2;-ms-grid-row:2;}\nd3fc-group.cartesian-chart>.left-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:1;-ms-grid-column:1;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.left-axis{width:3em;grid-column:2;-ms-grid-column:2;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.plot-area{overflow:hidden;grid-column:3;-ms-grid-column:3;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-axis{width:3em;grid-column:4;-ms-grid-column:4;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.right-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:5;-ms-grid-column:5;grid-row:3;-ms-grid-row:3;}\nd3fc-group.cartesian-chart>.bottom-axis{height:2em;grid-column:3;-ms-grid-column:3;grid-row:4;-ms-grid-row:4;}\nd3fc-group.cartesian-chart>.bottom-label{align-self:center;-ms-grid-column-align:center;justify-self:center;-ms-grid-row-align:center;grid-column:3;-ms-grid-column:3;grid-row:5;-ms-grid-row:5;}\nd3fc-group.cartesian-chart>.y-label{display:flex;transform:rotate(-90deg);width:1em;white-space:nowrap;justify-content:center;}";const Oa=e=>"function"==typeof e?e:()=>e;var Ha=(...e)=>{const{xScale:t,yScale:a,xAxis:n,yAxis:l}=Na(...e);let r=Oa(""),d=Oa(""),s=Oa(""),c=Oa(null),h=Oa(null),g=Oa("right"),u=Oa("bottom"),m=null,f=null,p=null,y=Da("tickFormat","ticks","tickArguments","tickSize","tickSizeInner","tickSizeOuter","tickValues","tickPadding","tickCenterLabel"),x=()=>{},v=Da("tickFormat","ticks","tickArguments","tickSize","tickSizeInner","tickSizeOuter","tickValues","tickPadding","tickCenterLabel"),b=()=>{},S=()=>{};const w=he("d3fc-group","cartesian-chart"),V=he("d3fc-canvas","gl-plot-area"),k=he("d3fc-canvas","canvas-plot-area"),A=he("d3fc-svg","plot-area"),E=he("d3fc-svg","x-axis").key(e=>e),I=he("d3fc-svg","y-axis").key(e=>e),T=he("div","chart-label"),_=he("div","x-label").key(e=>e),P=he("div","y-label").key(e=>e),B=e=>t=>e.selection?t.transition(e):t,z=e=>{const z=B(e);e.each((e,i,B)=>{const L=w(o.select(B[i]),[e]);L.enter().attr("auto-resize",""),T(L,[u(e)]).attr("class",e=>"top"===e?"chart-label bottom-label":"chart-label top-label").style("margin-bottom",e=>"top"===e?0:"1em").style("margin-top",e=>"top"===e?"1em":0).text(r(e)),_(L,[u(e)]).attr("class",e=>`x-label ${e}-label`).text(d(e)),P(L,[g(e)]).attr("class",e=>`y-label ${e}-label`).text(s(e)),V(L,m?[e]:[]).attr("set-webgl-viewport","").classed("plot-area",!0).on("draw",(e,n,i)=>{const l=o.select(i[n]).select("canvas").node();m.context(l.getContext("webgl")).xScale(t).yScale(a),m(e)}),k(L,f?[e]:[]).classed("plot-area",!0).on("draw",(e,n,i)=>{const l=o.select(i[n]).select("canvas").node();f.context(l.getContext("2d")).xScale(t).yScale(a),f(e)}),A(L,p?[e]:[]).on("draw",(e,n,i)=>{p.xScale(t).yScale(a),z(o.select(i[n])).select("svg").call(p)}),E(L,[u(e)]).attr("class",e=>`x-axis ${e}-axis`).style("height",c(e)).on("measure",(e,a,n)=>{const{width:i,height:l}=o.event.detail;"top"===e&&o.select(n[a]).select("svg").attr("viewBox",`0 ${-l} ${i} ${l}`),t.range([0,i])}).on("draw",(e,a,i)=>{const l="top"===e?n.top(t):n.bottom(t);l.decorate(x),z(o.select(i[a])).select("svg").call(y(l))}),I(L,[g(e)]).attr("class",e=>`y-axis ${e}-axis`).style("width",h(e)).on("measure",(e,t,n)=>{const{width:i,height:l}=o.event.detail;"left"===e&&o.select(n[t]).select("svg").attr("viewBox",`${-i} 0 ${i} ${l}`),a.range([l,0])}).on("draw",(e,t,n)=>{const i="left"===e?l.left(a):l.right(a);i.decorate(b),z(o.select(n[t])).select("svg").call(v(i))}),L.each((e,t,a)=>a[t].requestRedraw()),S(L,e,i)})},L=Z(/range\w*/,/tickFormat/);return j(z,t,L,te("x")),j(z,a,L,te("y")),j(z,y,te("x")),j(z,v,te("y")),z.xOrient=(...e)=>e.length?(u=Oa(e[0]),z):u,z.yOrient=(...e)=>e.length?(g=Oa(e[0]),z):g,z.xDecorate=(...e)=>e.length?(x=e[0],z):x,z.yDecorate=(...e)=>e.length?(b=e[0],z):b,z.chartLabel=(...e)=>e.length?(r=Oa(e[0]),z):r,z.xLabel=(...e)=>e.length?(d=Oa(e[0]),z):d,z.yLabel=(...e)=>e.length?(s=Oa(e[0]),z):s,z.xAxisHeight=(...e)=>e.length?(c=Oa(e[0]),z):c,z.yAxisWidth=(...e)=>e.length?(h=Oa(e[0]),z):h,z.webglPlotArea=(...e)=>e.length?(m=e[0],z):m,z.canvasPlotArea=(...e)=>e.length?(f=e[0],z):f,z.svgPlotArea=(...e)=>e.length?(p=e[0],z):p,z.decorate=(...e)=>e.length?(S=e[0],z):S,z};const Na=(...e)=>{const t={xScale:a.scaleIdentity(),yScale:a.scaleIdentity(),xAxis:{bottom:ra,top:la},yAxis:{right:oa,left:da}};return 1!==e.length||e[0].domain||e[0].range?Object.assign(t,{xScale:e[0]||t.xScale,yScale:e[1]||t.yScale}):Object.assign(t,e[0])},Wa=e=>"function"==typeof e?e:()=>e;var Qa=(e,t)=>(...a)=>{let n=Wa(""),i=t,l=()=>{};const r=Ha(...a),d=t=>{e(r,i),r.decorate((e,t,a)=>{e.enter().select(".x-label").style("height","1em").style("line-height","1em");const i=r.yOrient()(t);e.enter().append("div").attr("class","y-label-container").style("grid-column","left"===i?1:5).style("-ms-grid-column","left"===i?1:5).style("grid-row",3).style("-ms-grid-row",3).style("width","1em").style("display","flex").style("align-items","center").style("justify-content","center").style("white-space","nowrap").append("div").attr("class","y-label").style("transform","rotate(-90deg)"),e.select(".y-label-container>.y-label").text(n),l(e,t,a)}),t.call(r)};return j(d,r,J(/^x/,/^y/,"chartLabel")),d.yLabel=(...e)=>e.length?(n=Wa(e[0]),d):n,d.plotArea=(...e)=>e.length?(i=e[0],d):i,d.decorate=(...e)=>e.length?(l=e[0],d):l,d},Fa=Qa((e,t)=>e.svgPlotArea(t),Te),Ya=Qa((e,t)=>e.canvasPlotArea(t),_e);const Ga=e=>"x"===e?h.brushX():"y"===e?h.brushY():"xy"===e?h.brush():void 0,Ma=e=>[e[1],e[0]],Ua=e=>{const t=Ga(e),n=c.dispatch("brush","start","end");let i=a.scaleIdentity(),l=a.scaleIdentity();const r=he("g","brush"),d=(t,a,n)=>"x"===e?t.map(a):"y"===e?t.map(n):"xy"===e?[[a(t[0][0]),n(t[0][1])],[a(t[1][0]),n(t[1][1])]]:void 0,s=e=>d(e,a.scaleLinear().domain(i.range()).invert,a.scaleLinear().domain(Ma(l.range())).invert),h=e=>d(e,a.scaleLinear().domain(i.range()),a.scaleLinear().domain(Ma(l.range()))),g=t=>{const n=a.scaleLinear().domain(i.domain());return"x"===e?t.map(n.invert):"xy"===e?[n.invert(t[0][0]),n.invert(t[1][0])]:void 0},u=t=>{const n=a.scaleLinear().domain(Ma(l.domain()));return"y"===e?[t[1],t[0]].map(n.invert):"xy"===e?[n.invert(t[1][1]),n.invert(t[0][1])]:void 0},m=e=>{if(!(e.sourceEvent&&"draw"===e.sourceEvent.type))if(e.selection){const t=h(e.selection);n.call(e.type,{},{selection:t,xDomain:g(t),yDomain:u(t)})}else n.call(e.type,{},{})},f=e=>{e.each((e,a,n)=>{t.extent([[i.range()[0],l.range()[1]],[i.range()[1],l.range()[0]]]),t.on("end",()=>m(o.event)).on("brush",()=>m(o.event)).on("start",()=>m(o.event));const d=r(o.select(n[a]),[e]);d.call(t).call(t.move,e?s(e):null)})};return f.xScale=(...e)=>e.length?(i=e[0],f):i,f.yScale=(...e)=>e.length?(l=e[0],f):l,X(f,n,"on"),X(f,t,"filter","handleSize"),f};e.annotationCanvasBand=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n="horizontal",l=e=>e.from,r=e=>e.to,o=()=>{};const s=le().horizontalAlign("right").verticalAlign("top");var c=a=>{if("horizontal"!==n&&"vertical"!==n)throw new Error("Invalid orientation");const c=s.context(),h="horizontal"===n,g=h?e:t,u=h?t:e,m=g.range(),f=m[1]-m[0],p=h?"x":"y",y=h?"y":"x",x=h?"height":"width",v=h?"width":"height";a.forEach((e,t)=>{c.save(),c.beginPath(),c.strokeStyle="transparent",s[y](u(l(e))),s[p](m[0]),s[v](f),s[x](u(r(e))-u(l(e))),o(c,e,t),s.context(c)([e],t),c.fill(),c.stroke(),c.closePath(),c.restore()})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.orient=(...e)=>e.length?(n=e[0],c):n,c.decorate=(...e)=>e.length?(o=e[0],c):o,c.fromValue=(...e)=>e.length?(l=Zt(e[0]),c):l,c.toValue=(...e)=>e.length?(r=Zt(e[0]),c):r,X(c,s,"context"),c},e.annotationCanvasCrosshair=()=>{let e=e=>e.x,t=e=>e.y,n=a.scaleIdentity(),i=a.scaleIdentity();const l=Ot(),r=$t(),o=$t().orient("vertical"),s=a.scaleIdentity(),c=a.scaleIdentity(),h=Ut().series([r,o,l]).xScale(s).yScale(c).mapping(e=>[e]),g=a=>{a.forEach(a=>{s.range(n.range()),c.range(i.range()),l.crossValue(e).mainValue(t),r.value(t),o.value(e),h(a)})};g.x=(...t)=>t.length?(e=t[0],g):e,g.y=(...e)=>e.length?(t=e[0],g):t,g.xScale=(...e)=>e.length?(n=e[0],g):n,g.yScale=(...e)=>e.length?(i=e[0],g):i;const u=J("label","decorate");return j(g,r,u,te("y")),j(g,o,u,te("x")),X(g,l,"decorate"),X(g,h,"context"),g},e.annotationCanvasGridline=()=>{let e=()=>{},t=()=>{};const a=ea(),n=ea(),l=s.line(),r=()=>{const r=l.context(),o=a.scale(),s=n.scale();a().forEach((t,a)=>{r.save(),r.beginPath(),r.strokeStyle="#bbb",r.fillStyle="transparent",e(r,t,a),l.context(r)(s.domain().map(e=>[o(t),s(e)])),r.fill(),r.stroke(),r.closePath(),r.restore()}),n().forEach((e,a)=>{r.save(),r.beginPath(),r.strokeStyle="#bbb",r.fillStyle="transparent",t(r,e,a),l.context(r)(o.domain().map(t=>[o(t),s(e)])),r.fill(),r.stroke(),r.closePath(),r.restore()})};return r.yDecorate=(...e)=>e.length?(t=e[0],r):t,r.xDecorate=(...t)=>t.length?(e=t[0],r):e,j(r,a,te("x")),j(r,n,te("y")),X(r,l,"context"),r},e.annotationCanvasLine=$t,e.annotationSvgBand=()=>{let e=a.scaleIdentity(),t=a.scaleIdentity(),n="horizontal",i=e=>e.from,l=e=>e.to,r=()=>{};const d=he("g","annotation-band"),s=le().horizontalAlign("center").verticalAlign("center").x(0).y(0);var c=a=>{if(a.selection&&d.transition(a),"horizontal"!==n&&"vertical"!==n)throw new Error("Invalid orientation");const c="horizontal"===n,h=c?(e,t)=>`translate(${e}, ${t})`:(e,t)=>`translate(${t}, ${e})`,g=c?e:t,u=c?t:e,m=g.range(),f=m[1]-m[0],p=c?"height":"width",y=c?"width":"height",x=(...e)=>h((m[1]+m[0])/2,(u(l(...e))+u(i(...e)))/2);s[y](f),s[p]((...e)=>u(l(...e))-u(i(...e))),a.each((e,t,a)=>{var i=d(o.select(a[t]),e);i.enter().attr("transform",x).append("path").classed("band",!0),i.attr("class",`annotation-band ${n}`).attr("transform",x).select("path").attr("d",(e,t)=>s([e],t)),r(i,e,t)})};return c.xScale=(...t)=>t.length?(e=t[0],c):e,c.yScale=(...e)=>e.length?(t=e[0],c):t,c.orient=(...e)=>e.length?(n=e[0],c):n,c.decorate=(...e)=>e.length?(r=e[0],c):r,c.fromValue=(...e)=>e.length?(i=Zt(e[0]),c):i,c.toValue=(...e)=>e.length?(l=Zt(e[0]),c):l,c},e.annotationSvgCrosshair=function(){let e=e=>e.x,t=e=>e.y,n=a.scaleIdentity(),i=a.scaleIdentity(),l=()=>{};const r=he("g","annotation-crosshair"),d=Rt(),s=Jt(),c=Jt().orient("vertical"),h=a.scaleIdentity(),u=a.scaleIdentity(),m=Mt().series([s,c,d]).xScale(h).yScale(u).mapping(e=>[e]),f=a=>{a.selection&&r.transition(a),a.each((a,f,p)=>{const y=r(o.select(p[f]),a);y.enter().style("pointer-events","none"),h.range(n.range()),u.range(i.range()),d.crossValue(e).mainValue(t),s.value(t),c.value(e),y.call(m),l(y,a,f)})};f.x=(...t)=>t.length?(e=t[0],f):e,f.y=(...e)=>e.length?(t=e[0],f):t,f.xScale=(...e)=>e.length?(n=e[0],f):n,f.yScale=(...e)=>e.length?(i=e[0],f):i,f.decorate=(...e)=>e.length?(l=e[0],f):l;const p=J("label");return j(f,s,p,te("y")),j(f,c,p,te("x")),f},e.annotationSvgGridline=()=>{let e=()=>{},t=()=>{};const a=ea(),n=ea(),i=he("line","gridline-y").key(ta),l=he("line","gridline-x").key(ta),r=r=>{r.selection&&(i.transition(r),l.transition(r)),r.each((r,d,s)=>{const c=s[d],h=o.select(s[d]),g=a.scale(),u=n.scale(),m=c.__x_scale__||g;c.__x_scale__=g.copy();const f=a(),p=i(h,f);p.enter().attr("x1",m).attr("x2",m).attr("y1",u.range()[0]).attr("y2",u.range()[1]),p.attr("x1",g).attr("x2",g).attr("y1",u.range()[0]).attr("y2",u.range()[1]).attr("stroke","#bbb"),p.exit().attr("x1",g).attr("x2",g),e(p,f,d);const y=c.__y_scale__||u;c.__y_scale__=u.copy();const x=n(),v=l(h,x);v.enter().attr("y1",y).attr("y2",y).attr("x1",g.range()[0]).attr("x2",g.range()[1]),v.attr("y1",u).attr("y2",u).attr("x1",g.range()[0]).attr("x2",g.range()[1]).attr("stroke","#bbb"),v.exit().attr("y1",u).attr("y2",u),t(v,x,d)})};return r.yDecorate=(...e)=>e.length?(t=e[0],r):t,r.xDecorate=(...t)=>t.length?(e=t[0],r):e,j(r,i,$({key:"xKey"})),j(r,l,$({key:"yKey"})),j(r,a,te("x")),j(r,n,te("y")),r},e.annotationSvgLine=Jt,e.autoBandwidth=e=>{let a=.75;const n=e=>{if(1>=e.length)return 10;e=jt(e);const n=t.pairs(e).map(e=>Y(e[0]-e[1])),i=t.min(n);return a*i},i=(t,a,i)=>{if(t.bandwidth)return t.bandwidth();else{const l=Array.isArray(a)?[].concat(...a):a,r=l.filter(e.defined()).map(i()).map(t),d=n(r);return d}},l=t=>{const a=t=>{if(e.xBandwidth&&e.yBandwidth)e.xBandwidth(i(e.xScale(),t,e.xValue)),e.yBandwidth(i(e.yScale(),t,e.yValue));else{const a=e.orient&&"horizontal"===e.orient()?e.yScale():e.xScale();e.bandwidth(i(a,t,e.crossValue))}};t instanceof o.selection?t.each((t,n,i)=>{a(t),e(o.select(i[n]))}):(a(t),e(t))};return j(l,e),l.widthFraction=(...e)=>e.length?(a=e[0],l):a,l},e.axisBottom=ra,e.axisLabelOffset=e=>{let t="auto",a=()=>{};const n=()=>"left"===e.orient()||"right"===e.orient(),l=()=>"top"===e.orient()||"left"===e.orient()?-1:1,r=a=>{const{maxHeight:r,maxWidth:d,labelCount:o}=ca(e.scale())(a),s=e.scale().range()[1],c="auto"===t?H((n()?r:d)*o/s)+1:t,h=a.select("text"),g=h.attr("transform"),u=e=>n()?`translate(${e%c*d*l()}, 0)`:`translate(0, ${e%c*r*l()})`;h.attr("transform",(e,t)=>`${g} ${u(t)}`)},d=t=>e(t);return e.decorate(e=>{r(e),a(e)}),d.decorate=(...e)=>e.length?(a=e[0],d):a,d.labelOffsetDepth=(...e)=>e.length?(t=e[0],d):t,j(d,e,Z("decorate")),d},e.axisLabelRotate=e=>{let t="auto",a=()=>{};const n=()=>"left"===e.orient()||"right"===e.orient(),i=()=>"top"===e.orient()||"left"===e.orient()?-1:1,l=()=>{switch(e.orient()){case"top":case"right":return"start";default:return"end";}},r=a=>{const{maxHeight:r,maxWidth:d,labelCount:o}=ca(e.scale())(a),s=o*d;let c;if("auto"===t){const t=e.scale().range()[1];c=t<s?90*N(1,(s/t-.8)/2):0}else c=t;return{rotate:n()?H(i()*(90-c)):H(-c),maxHeight:r,maxWidth:d,anchor:c?l():"middle"}},d=e=>{const{rotate:t,maxHeight:a,anchor:l}=r(e),d=e.select("text"),o=d.attr("transform"),s=i()*H(a/2),c=n()?`translate(${s}, 0)`:`translate(0, ${s})`;d.style("text-anchor",l).attr("transform",`${o} ${c} rotate(${t} 0 0)`)},o=t=>{e(t)};return e.decorate(e=>{d(e),a(e)}),o.decorate=(...e)=>e.length?(a=e[0],o):a,o.labelRotate=(...e)=>e.length?(t=e[0],o):t,j(o,e,Z("decorate")),o},e.axisLeft=da,e.axisOrdinalBottom=e=>sa("bottom",e),e.axisOrdinalLeft=e=>sa("left",e),e.axisOrdinalRight=e=>sa("right",e),e.axisOrdinalTop=e=>sa("top",e),e.axisRight=oa,e.axisTop=la,e.barFill=()=>{let e=[.86,.86,.86,1];const t=t=>{t.vertexShader().appendHeaderIfNotExists(Me.header).appendBodyIfNotExists(Me.body),t.fragmentShader().appendHeaderIfNotExists(ht.header).appendBodyIfNotExists(ht.body),t.buffers().uniform("uColor",Ce(e))};return t.color=(...a)=>{if(!a.length)return e;const n=a[0],i="0x"+n[1]+n[2],l="0x"+n[3]+n[4],r="0x"+n[5]+n[6];return e=[+(i/255),+(l/255),+(r/255),1],t},t},e.baseAttributeBuilder=ze,e.brush=()=>Ua("xy"),e.brushX=()=>Ua("x"),e.brushY=()=>Ua("y"),e.bucket=z,e.bufferBuilder=Pe,e.chartCanvasCartesian=Ya,e.chartCartesian=Ha,e.chartSvgCartesian=Fa,e.circlePointShader=pt,e.dataJoin=he,e.discontinuityIdentity=V,e.discontinuityRange=(...e)=>{const t=(e,t)=>e>t[0]&&e<t[1],a=(e,t)=>e[0]>=t[0]&&e[1]<=t[1];var n={};n.distance=(t,i)=>{t=n.clampUp(t),i=n.clampDown(i);const l=e.filter(e=>a(e,[t,i])),r=l.map(e=>e[1]-e[0]);return i-t-r.reduce((e,t)=>e+t,0)};const i=(e,t)=>e instanceof Date?new Date(e.getTime()+t):e+t;return n.offset=(t,a)=>{if(0<a){let l=n.clampUp(t),r=a;for(;0<r;){const t=e.filter(e=>e[0]>l).sort((e,t)=>e[0]-t[0]);if(t.length){const e=t[0],a=e[0]-l;a>r?(l=i(l,r),r=0):(l=e[1],r-=a)}else l=i(l,r),r=0}return l}else{let l=n.clampDown(t),r=a;for(;0>r;){const t=e.filter(e=>e[1]<l).sort((e,t)=>t[0]-e[0]);if(t.length){const e=t[0],a=e[1]-l;a<r?(l=i(l,r),r=0):(l=e[0],r-=a)}else l=i(l,r),r=0}return l}},n.clampUp=a=>e.reduce((e,a)=>t(e,a)?a[1]:e,a),n.clampDown=a=>e.reduce((e,a)=>t(e,a)?a[0]:e,a),n.copy=()=>n,n},e.discontinuitySkipUtcWeekends=()=>ae(e=>e.getUTCDay(),n.utcDay,n.utcSaturday,n.utcMonday),e.discontinuitySkipWeekends=()=>ae(e=>e.getDay(),n.timeDay,n.timeSaturday,n.timeMonday),e.effectivelyZero=ce,e.exclude=Z,e.extentDate=I,e.extentLinear=E,e.extentTime=I,e.feedGdax=B,e.fragmentShaderSnippets=ft,e.glArea=zt,e.glBar=Tt,e.glBoxPlot=Dt,e.glCandlestick=Lt,e.glErrorBar=Pt,e.glLine=kt,e.glOhlc=Et,e.glPoint=wt,e.glScaleLinear=Qe,e.glScaleLog=Fe,e.glScalePow=Ye,e.group=()=>{let e="",t="vertical",a=(e,t)=>+e[t];const n=t=>Object.keys(t[0]).filter(t=>t!==e).map(n=>{const i=t.filter(e=>e[n]).map(t=>{const i=[t[e],a(t,n)];return i.data=t,i});return i.key=n,i}),i=t=>t.map(t=>{const n=Object.keys(t).filter(t=>t!==e).map(e=>{const n=[e,a(t,e)];return n.data=t,n});return n.key=t[e],n}),l=e=>"vertical"===t?n(e):i(e);return l.key=(...t)=>t.length?(e=t[0],l):e,l.value=(...e)=>e.length?(a=e[0],l):a,l.orient=(...e)=>e.length?(t=e[0],l):t,l},e.include=J,e.includeMap=$,e.indicatorBollingerBands=y,e.indicatorElderRay=w,e.indicatorEnvelope=S,e.indicatorExponentialMovingAverage=x,e.indicatorForceIndex=function(){let e=e=>e.volume,t=e=>e.close;const a=x().period(13),n=p().period(2).defined(a=>null!=t(a)&&null!=e(a)).accumulator(a=>a&&f((t(a[1])-t(a[0]))*e(a[1]))),i=e=>{const t=n(e);return a(t)};return i.volumeValue=(...t)=>t.length?(e=t[0],i):e,i.closeValue=(...e)=>e.length?(t=e[0],i):t,X(i,a,"period"),i},e.indicatorMacd=v,e.indicatorMovingAverage=b,e.indicatorRelativeStrengthIndex=function(){const e=p().period(14),a=(e,t)=>t+(e[e.length-1]-t)/e.length,n=([e,t])=>e<t?0:e-t,i=([e,t])=>e>t?0:t-e,l=(e,n)=>void 0===n?t.mean(e):a(e,n),r=()=>{let e,a,r;return d=>{if(!d)return void(void 0!==e&&(e=NaN));if(void 0===e)return void(e=d[0]);const o=t.pairs([e,...d]);a=l(o.map(n),a),r=l(o.map(i),r);const s=isNaN(e)?NaN:r/a;return f(100-100/(1+s))}};var d=t=>{const a=r();return e.accumulator(a),e(t)};return X(d,e,"period","value"),d},e.indicatorStochasticOscillator=function(){let e=e=>e.close,a=e=>e.high,n=e=>e.low;const i=p().period(5).defined(t=>null!=e(t)&&null!=a(t)&&null!=n(t)).accumulator(i=>{const l=i&&t.max(i,a),r=i&&t.min(i,n),d=i&&100*(e(i[i.length-1])-r)/(l-r);return f(d)}),l=b().period(3),r=e=>{const t=i(e),a=l(t);return t.map((e,t)=>({k:e,d:a[t]}))};return r.closeValue=(...t)=>t.length?(e=t[0],r):e,r.highValue=(...e)=>e.length?(a=e[0],r):a,r.lowValue=(...e)=>e.length?(n=e[0],r):n,j(r,i,$({period:"kPeriod"})),j(r,l,$({period:"dPeriod"})),r},e.largestTriangleOneBucket=L,e.largestTriangleThreeBucket=C,e.layoutAnnealing=()=>{let e,t=1e3,a=1;const n=e=>{switch(e.location){case"bottom-right":return 0;case"middle-right":case"bottom-center":return e.width*e.height/8;}return e.width*e.height/4},i=t=>e?t.width*t.height-ue(t,e):0,l=(e,t,a)=>me(a,t)+i(e)+n(e),r=e=>{let n=t;const i=(e,t)=>Q((t-e)/n)>Math.random();let r=ve().locationScore(l).winningScore(i).rectangles(e);for(;0<n;){const t=Se(e),i=be(pe(e[t]));r=r(i,t),n-=a}return r.rectangles()};return r.temperature=(...e)=>e.length?(t=e[0],r):t,r.cooling=(...e)=>e.length?(a=e[0],r):a,r.bounds=(...t)=>t.length?(e=t[0],r):e,r},e.layoutBoundingBox=()=>{let e=[0,0];const t=t=>t.map(t=>{let a=t.x,n=t.y;return a+t.width>e[0]&&(a-=t.width),n+t.height>e[1]&&(n-=t.height),{height:t.height,width:t.width,x:a,y:n}});return t.bounds=(...a)=>a.length?(e=a[0],t):e,t},e.layoutGreedy=()=>{let e;const t=t=>e?t.width*t.height-ue(t,e):0,a=(e,a,n)=>me(n,a)+t(e),n=e=>{let t=ve().locationScore(a).rectangles(e);return e.forEach((e,a)=>{pe(e).forEach(e=>{t=t(e,a)})}),t.rectangles()};return n.bounds=(...t)=>t.length?(e=t[0],n):e,n},e.layoutLabel=e=>{let t=()=>{},n=()=>[0,0],l=e=>[e.x,e.y],r=e||(e=>e),d=()=>{},s=a.scaleIdentity(),c=a.scaleIdentity();const h=he("g","label"),g=e=>{e.each((e,a,i)=>{const u=h(o.select(i[a]),e).call(d),g=u.nodes(),m=g.map((e,t)=>{let a=o.select(e).datum();const i=l(a,t,g);let r=[s(i[0]),c(i[1])],d=n(a,t,g);return{hidden:!1,x:r[0],y:r[1],width:d[0],height:d[1]}}),f=r(m);u.attr("style",(e,t)=>"display:"+(f[t].hidden?"none":"inherit")).attr("transform",(e,t)=>"translate("+f[t].x+", "+f[t].y+")").attr("layout-width",(e,t)=>f[t].width).attr("layout-height",(e,t)=>f[t].height).attr("anchor-x",(e,t)=>m[t].x-f[t].x).attr("anchor-y",(e,t)=>m[t].y-f[t].y),u.call(d),t(u,e,a)})};return j(g,h,J("key")),j(g,r),g.size=(...e)=>e.length?(n=se(e[0]),g):n,g.position=(...e)=>e.length?(l=se(e[0]),g):l,g.component=(...e)=>e.length?(d=e[0],g):d,g.decorate=(...e)=>e.length?(t=e[0],g):t,g.xScale=(...e)=>e.length?(s=e[0],g):s,g.yScale=(...e)=>e.length?(c=e[0],g):c,g},e.layoutRemoveOverlaps=e=>{e=e||(e=>e);const t=t=>{for(t=e(t);;){const e=t.filter(e=>!e.hidden),a=e.map((t,a)=>[t,me(e,a)]),n=we(a,(e,t)=>t[1]-e[1]);if(0<n[1])n[0].hidden=!0;else break}return t};return j(t,e),t},e.layoutTextLabel=()=>{let e=2,t=e=>e;const a=he("text"),n=he("rect"),i=he("circle"),l=l=>{l.each((l,r,d)=>{const s=d[r],c=o.select(s);let h=+s.getAttribute("layout-width"),g=+s.getAttribute("layout-height"),u=n(c,[l]);u.attr("width",h).attr("height",g);let m=+s.getAttribute("anchor-x"),f=+s.getAttribute("anchor-y"),p=i(c,[l]);p.attr("r",2).attr("cx",m).attr("cy",f);let y=a(c,[l]);y.enter().attr("dy","0.9em").attr("transform",`translate(${e}, ${e})`),y.text(t)})};return l.padding=(...t)=>t.length?(e=t[0],l):e,l.value=(...e)=>e.length?(t=se(e[0]),l):t,l},e.lineWidth=St,e.modeMedian=D,e.pointAntiAlias=()=>{return e=>{e.fragmentShader().appendBodyIfNotExists(ct.body)}},e.pointFill=()=>{let e=[.86,.86,.86,1];const t=t=>{t.fragmentShader().appendHeaderIfNotExists(gt.header).appendBodyIfNotExists(gt.body),t.buffers().uniform("uColor",Ce(e))};return t.color=(...a)=>a.length?(e=a[0],t):e,t},e.pointStroke=()=>{let e=[0,0,0,1],t=1;const a=a=>{a.fragmentShader().appendHeaderIfNotExists(ut.header).appendBodyIfNotExists(ut.body),a.buffers().uniform("uEdgeColor",Ce(e)),a.buffers().uniform("uLineWidth",Ce(t))};return a.color=(...t)=>t.length?(e=t[0],a):e,a.width=(...e)=>e.length?(t=e[0],a):t,a},e.pointer=()=>{function e(){const e=o.mouse(this);a.call("point",this,[{x:e[0],y:e[1]}])}function t(){void a.call("point",this,[])}const a=c.dispatch("point"),n=a=>{a.on("mouseenter.pointer",e).on("mousemove.pointer",e).on("mouseleave.pointer",t)};return X(n,a,"on"),n},e.prefix=te,e.programBuilder=Ne,e.projectedAttributeBuilder=Le,e.randomFinancial=P,e.randomGeometricBrownianMotion=T,e.randomSkipWeekends=function(e){const t=e.date.getDay();return 0!==t&&6!==t},e.rebind=X,e.rebindAll=j,e.scaleDiscontinuous=A,e.scaleMapper=Ge,e.seriesCanvasArea=()=>{const e=Ee(),t=s.area(),a=a=>{const n=t.context();t.defined(e.defined());const l=a.map(e.values);t.x((e,t)=>l[t].transposedX).y((e,t)=>l[t].transposedY);const r="vertical"===e.orient()?"y":"x";t[r+"0"]((e,t)=>l[t].y0),t[r+"1"]((e,t)=>l[t].y),n.beginPath(),t(a),n.fillStyle=Ie.gray,n.strokeStyle="transparent",e.decorate()(n,a),n.fill(),n.stroke(),n.closePath()};return j(a,e,Z("bandwidth","align")),X(a,t,"curve","context"),a},e.seriesCanvasBar=()=>{const e=Ee(),t=le().x(0).y(0),a=t=>"vertical"===e.orient()?t.height:t.width,n=t=>"vertical"===e.orient()?t.width:t.height,i=i=>{const l=t.context(),r=i.filter(e.defined()),d=r.map(e.values);"vertical"===e.orient()?(t.verticalAlign("top"),t.horizontalAlign("center")):(t.horizontalAlign("right"),t.verticalAlign("center")),d.forEach((r,d)=>{l.save(),l.beginPath(),l.translate(r.origin[0],r.origin[1]),a(t)(-r.height),n(t)(r.width),t([r]),l.fillStyle=Ie.darkGray,l.strokeStyle="transparent",e.decorate()(l,r.d,d),l.fill(),l.stroke(),l.closePath(),l.restore()})};return j(i,e),X(i,t,"context"),i},e.seriesCanvasBoxPlot=()=>{const e=Yt(),t=de().value(0),a=a=>{const n=a.filter(e.defined()),l=t.context();t.orient(e.orient()),n.forEach((a,n)=>{l.save();const i=e.values(a,n);l.translate(i.origin[0],i.origin[1]),l.beginPath(),t.median(i.median).upperQuartile(i.upperQuartile).lowerQuartile(i.lowerQuartile).high(i.high).width(i.width).low(i.low)([a]),l.fillStyle=Ie.gray,l.strokeStyle=Ie.black,e.decorate()(l,a,n),l.fill(),l.stroke(),l.closePath(),l.restore()})};return j(a,e),X(a,t,"cap","context"),a},e.seriesCanvasCandlestick=()=>Qt(re()),e.seriesCanvasErrorBar=()=>{const e=Ht(),t=oe().value(0),a=a=>{const n=a.filter(e.defined()),l=t.context();t.orient(e.orient()),n.forEach((a,n)=>{l.save();const i=e.values(a,n);l.translate(i.origin[0],i.origin[1]),l.beginPath(),t.high(i.high).width(i.width).low(i.low)([a]),l.strokeStyle=Ie.black,l.fillStyle=Ie.gray,e.decorate()(l,a,n),l.fill(),l.stroke(),l.closePath(),l.restore()})};return j(a,e),X(a,t,"context"),a},e.seriesCanvasGrouped=function(e){const t=Xt(),a=a=>{a.forEach((n,l)=>{const r="horizontal"!==e.orient(),d=(e,n)=>{const i=t.offsetScaleForDatum(a,e,n),d=r?t.xScale():t.yScale();return d(e)+i(l)+i.bandwidth()/2};r?(e.xScale(d),e.yScale(t.yScale())):(e.yScale(d),e.xScale(t.xScale())),e.bandwidth&&e.bandwidth((e,n)=>t.offsetScaleForDatum(a,e,n).bandwidth()),e.decorate((e,a)=>t.decorate()(e,a,l)),e(n)})};return j(a,e,Z("decorate","xScale","yScale")),j(a,t,Z("offsetScaleForDatum")),a},e.seriesCanvasHeatmap=()=>{const e=Kt(),t=t=>{const a=t.filter(e.defined()),n=e.colorInterpolate(),l=e.colorScale(a),r=e.pathGenerator.context();a.forEach((t,a)=>{r.save(),r.beginPath();const i=e.values(t,a);r.translate(i.x,i.y),r.fillStyle=n(l(i.colorValue)),r.strokeStyle="transparent",e.pathGenerator.height(i.height).width(i.width)([t]),e.decorate()(r,t,a),r.fill(),r.stroke(),r.closePath(),r.restore()})};return X(t,e.pathGenerator,"context"),j(t,e),t},e.seriesCanvasLine=_e,e.seriesCanvasMulti=Ut,e.seriesCanvasOhlc=()=>Qt(ie()),e.seriesCanvasPoint=Ot,e.seriesCanvasRepeat=qt,e.seriesSvgArea=()=>{const e=Ee(),t=s.area(),a=he("path","area"),n=n=>{n.selection&&a.transition(n),t.defined(e.defined()),n.each((n,i,l)=>{const r=n.map(e.values);t.x((e,t)=>r[t].transposedX).y((e,t)=>r[t].transposedY);const d="vertical"===e.orient()?"y":"x";t[d+"0"]((e,t)=>r[t].y0),t[d+"1"]((e,t)=>r[t].y);const s=a(o.select(l[i]),[n]);s.enter().attr("fill",Ie.gray),s.attr("d",t),e.decorate()(s,n,i)})};return j(n,e,Z("bandwidth","align")),X(n,a,"key"),X(n,t,"curve"),n},e.seriesSvgBar=()=>{const e=le().x(0).y(0),t=Ee(),a=he("g","bar"),n=e=>"vertical"===t.orient()?e.height:e.width,l=e=>"vertical"===t.orient()?e.width:e.height,r=e=>"translate("+e[0]+", "+e[1]+")",d=i=>{i.selection&&a.transition(i),i.each((i,d,s)=>{const c=t.orient();if("vertical"!==c&&"horizontal"!==c)throw new Error("The bar series does not support an orientation of "+c);const h=i.filter(t.defined()),u=h.map(t.values);e.width(0).height(0),"vertical"===t.orient()?(e.verticalAlign("top"),e.horizontalAlign("center")):(e.horizontalAlign("right"),e.verticalAlign("center"));const m=a(o.select(s[d]),h);m.enter().attr("transform",(e,t)=>r(u[t].baseOrigin)).attr("class","bar "+t.orient()).attr("fill",Ie.darkGray).append("path").attr("d",(t,a)=>(l(e)(u[a].width),e([t]))),m.attr("transform",(e,t)=>r(u[t].origin)).select("path").attr("d",(t,a)=>(l(e)(u[a].width),n(e)(-u[a].height),e([t]))),t.decorate()(m,h,d)})};return j(d,t),X(d,a,"key"),d},e.seriesSvgBoxPlot=()=>{const e=Yt(),t=he("g","box-plot"),a=de().value(0),n=e=>t=>e.selection?t.transition(e):t,l=e=>"translate("+e.origin[0]+", "+e.origin[1]+")",r=i=>{i.selection&&t.transition(i);const r=n(i);i.each((n,i,d)=>{const s=n.filter(e.defined()),c=t(o.select(d[i]),s);c.enter().attr("stroke",Ie.black).attr("fill",Ie.gray).attr("transform",(t,a)=>l(e.values(t,a))+" scale(1e-6, 1)").append("path"),a.orient(e.orient()),c.each((t,n,i)=>{const d=e.values(t,n);a.median(d.median).upperQuartile(d.upperQuartile).lowerQuartile(d.lowerQuartile).width(d.width).high(d.high).low(d.low),r(o.select(i[n])).attr("transform",l(d)).select("path").attr("d",a([t]))}),e.decorate()(c,n,i)})};return j(r,e),X(r,t,"key"),X(r,a,"cap"),r},e.seriesSvgCandlestick=()=>Wt(re(),"candlestick"),e.seriesSvgErrorBar=()=>{const e=Ht(),t=he("g","error-bar"),a=oe().value(0),n=e=>t=>e.selection?t.transition(e):t,l=e=>"translate("+e.origin[0]+", "+e.origin[1]+")",r=i=>{i.selection&&t.transition(i);const r=n(i);i.each((n,i,d)=>{const s=n.filter(e.defined()),c=s.map(e.values),h=t(o.select(d[i]),s);h.enter().attr("stroke",Ie.black).attr("fill",Ie.gray).attr("transform",(t,a)=>l(e.values(t,a))+" scale(1e-6, 1)").append("path"),a.orient(e.orient()),h.each((e,t,n)=>{const i=c[t];a.high(i.high).low(i.low).width(i.width),r(o.select(n[t])).attr("transform",l(i)+" scale(1)").select("path").attr("d",a([e]))}),e.decorate()(h,n,i)})};return j(r,e),X(r,t,"key"),r},e.seriesSvgGrouped=e=>{const t=Xt(),a=he("g","grouped"),n=n=>{n.selection&&a.transition(n),n.each((n,i,l)=>{const r=a(o.select(l[i]),n);r.enter().append("g"),r.select("g").each((a,l,r)=>{const d=o.select(r[l]),s="horizontal"!==e.orient(),c=(e,a)=>{const i=t.offsetScaleForDatum(n,e,a),r=s?t.xScale():t.yScale();return r(e)+i(l)+i.bandwidth()/2};s?(e.xScale(c),e.yScale(t.yScale())):(e.yScale(c),e.xScale(t.xScale())),e.bandwidth&&e.bandwidth((e,a)=>t.offsetScaleForDatum(n,e,a).bandwidth()),e.decorate((e,a)=>t.decorate()(e,a,l)),d.call(e)})})};return j(n,e,Z("decorate","xScale","yScale")),j(n,t,Z("offsetScaleForDatum")),n},e.seriesSvgHeatmap=()=>{const e=Kt(),t=he("g","box"),a=e=>"translate("+e.x+", "+e.y+")",n=n=>{n.each((n,i,l)=>{const r=n.filter(e.defined()),s=e.colorValue(),c=e.colorInterpolate(),h=e.colorScale(r),u=t(o.select(l[i]),r);u.enter().append("path").attr("stroke","transparent"),u.attr("transform",(t,n)=>a(e.values(t,n))).select("path").attr("d",(t,a)=>e.pathGenerator.width(e.values(t,a).width).height(e.values(t,a).height)([t])).attr("fill",(e,t)=>c(h(s(e,t)))),e.decorate()(u,n,i)})};return j(n,e),n},e.seriesSvgLine=Te,e.seriesSvgMulti=Mt,e.seriesSvgOhlc=()=>Wt(ie(),"ohlc"),e.seriesSvgPoint=Rt,e.seriesSvgRepeat=()=>{let e="vertical",t=Te();const a=Mt(),n=n=>n.each((n,i,l)=>{"vertical"===e?a.series(n[0].map(()=>t)).mapping((e,t)=>e.map(e=>e[t])):a.series(n.map(()=>t)).mapping((e,t)=>e[t]),o.select(l[i]).call(a)});return n.series=(...e)=>e.length?(t=e[0],n):t,n.orient=(...t)=>t.length?(e=t[0],n):e,j(n,a,Z("series","mapping")),n},e.seriesWebglArea=()=>{const e=Ee(),t=zt(),a=a=>{const n=Ge(e.xScale()),l=Ge(e.yScale()),r=new Float32Array(a.length),o=new Float32Array(a.length),s=new Float32Array(a.length),c=new Float32Array(a.length);a.forEach((t,a)=>{r[a]=n.scale(e.crossValue()(t,a)),o[a]=l.scale(e.mainValue()(t,a)),s[a]=l.scale(e.baseValue()(t,a)),c[a]=e.defined()(t,a)}),t.xValues(r).yValues(o).y0Values(s).defined(c).xScale(n.glScale).yScale(l.glScale).decorate(t=>e.decorate()(t,a,0)),t(a.length)};return j(a,e,Z("bandwidth","align")),X(a,t,"context"),a},e.seriesWebglBar=()=>{const e=Ee(),t=Tt(),a=a=>{const n=a.filter(e.defined()),l=Ge(e.xScale()),r=Ge(e.yScale()),o=new Float32Array(n.length),s=new Float32Array(n.length),c=new Float32Array(n.length),h=new Float32Array(n.length);n.forEach((t,a)=>{o[a]=l.scale(e.crossValue()(t,a)),s[a]=r.scale(e.baseValue()(t,a)),c[a]=r.scale(e.mainValue()(t,a)),h[a]=r.scale(e.bandwidth()(t,a))}),t.xValues(o).y0Values(s).yValues(c).widths(h).xScale(l.glScale).yScale(r.glScale).decorate(t=>{e.decorate()(t,n,0)}),t(n.length)};return j(a,e,Z("align")),X(a,t,"context"),a},e.seriesWebglBoxPlot=()=>{const e=Yt();let t=Ve(.5);const a=Dt(),n=n=>{const i=n.filter(e.defined()),l=Ge(e.xScale()),r=Ge(e.yScale()),o=new Float32Array(i.length),s=new Float32Array(i.length),c=new Float32Array(i.length),h=new Float32Array(i.length),g=new Float32Array(i.length),u=new Float32Array(i.length),m=new Float32Array(i.length),f=new Float32Array(i.length);i.forEach((a,n)=>{o[n]=l.scale(e.crossValue()(a,n)),s[n]=r.scale(e.medianValue()(a,n)),c[n]=r.scale(e.upperQuartileValue()(a,n)),h[n]=l.scale(e.lowerQuartileValue()(a,n)),g[n]=r.scale(e.highValue()(a,n)),u[n]=r.scale(e.lowValue()(a,n)),m[n]=e.bandwidth()(a,n),f[n]=m[n]*t(a,n)}),a.xValues(o).medianValues(s).upperQuartileValues(c).lowerQuartileValues(h).highValues(g).lowValues(u).bandwidth(m).capWidth(f).xScale(l.glScale).yScale(r.glScale),a(i.length)};return n.cap=(...e)=>e.length?(t=Ve(e[0]),n):t,j(n,e,Z("align")),X(n,a,"context","lineWidth"),n},e.seriesWebglCandlestick=()=>Ft(Lt()),e.seriesWebglErrorBar=()=>{const e=Ht(),t=Pt(),a=a=>{const n=a.filter(e.defined()),l=Ge(e.xScale()),r=Ge(e.yScale()),o=new Float32Array(n.length),s=new Float32Array(n.length),c=new Float32Array(n.length),h=new Float32Array(n.length);n.forEach((t,a)=>{o[a]=l.scale(e.crossValue()(t,a)),s[a]=r.scale(e.highValue()(t,a)),c[a]=r.scale(e.lowValue()(t,a)),h[a]=e.bandwidth()(t,a)}),t.xValues(o).highValues(s).lowValues(c).bandwidth(h).xScale(l.glScale).yScale(r.glScale),t(n.length)};return j(a,e,Z("align")),X(a,t,"context","lineWidth"),a},e.seriesWebglLine=()=>{function e(){return"vertical"===t.orient()?{x:t.crossValue(),y:t.mainValue(),defined:t.defined()}:{x:t.mainValue(),y:t.crossValue(),defined:t.defined()}}const t=Ee(),a=kt(),n=n=>{const l=Ge(t.xScale()),r=Ge(t.yScale()),o=e(),s=new Float32Array(n.length),c=new Float32Array(n.length),h=new Float32Array(n.length);n.forEach((e,t)=>{s[t]=l.scale(o.x(e,t)),c[t]=r.scale(o.y(e,t)),h[t]=o.defined(e,t)}),a.xValues(s).yValues(c).defined(h).xScale(l.glScale).yScale(r.glScale).decorate(e=>{t.decorate()(e,n,0)}),a(n.length)};return j(n,t,Z("baseValue","bandwidth","align")),X(n,a,"context","lineWidth"),n},e.seriesWebglMulti=Ut,e.seriesWebglOhlc=()=>Ft(Et()),e.seriesWebglPoint=()=>{function e(){return"vertical"===t.orient()?{x:t.crossValue(),y:t.mainValue()}:{x:t.mainValue(),y:t.crossValue()}}const t=Ee();let a=64,n=M.symbolCircle;const i=wt(),l=l=>{const r=l.filter(t.defined()),o=Ge(t.xScale()),s=Ge(t.yScale()),c=bt(n),h=e(),g=new Float32Array(r.length),u=new Float32Array(r.length),m=new Float32Array(r.length);r.forEach((e,t)=>{const n="function"==typeof a?a:()=>a;g[t]=o.scale(h.x(e,t)),u[t]=s.scale(h.y(e,t)),m[t]=n(e)}),i.xValues(g).yValues(u).sizes(m).xScale(o.glScale).yScale(s.glScale).type(c).decorate(e=>t.decorate()(e,r,0)),i(r.length)};return l.size=(...e)=>e.length?(a=e[0],l):a,l.type=(...e)=>e.length?(n=e[0],l):n,j(l,t,Z("baseValue","bandwidth","align")),X(l,i,"context"),l},e.seriesWebglRepeat=qt,e.shaderBuilder=De,e.shapeBar=le,e.shapeBoxPlot=de,e.shapeCandlestick=re,e.shapeErrorBar=oe,e.shapeOhlc=ie,e.squarePointShader=yt,e.symbolMapper=bt,e.uniformBuilder=Ce,e.vertexShaderSnippets=nt,Object.defineProperty(e,"__esModule",{value:!0})});
